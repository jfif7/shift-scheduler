(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{143:(e,t,s)=>{"use strict";s.d(t,{LocaleProvider:()=>l,Y:()=>o});var a=s(5155),r=s(2115),i=s(6096);let n=(0,r.createContext)(void 0);function l(e){let{children:t}=e,[l,o]=(0,r.useState)("en"),[c,d]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let e=localStorage.getItem("locale");e&&("en"===e||"zh-TW"===e)&&o(e)},[]),(0,r.useEffect)(()=>{(async()=>{try{let e=await s(5272)("./".concat(l,".json"));d(e.default)}catch(e){console.error("Failed to load messages:",e)}})()},[l]),c)?(0,a.jsx)(n.Provider,{value:{locale:l,setLocale:e=>{o(e),localStorage.setItem("locale",e)}},children:(0,a.jsx)(i.A,{locale:l,messages:c,children:t})}):(0,a.jsx)("div",{children:"Loading..."})}function o(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useLocale must be used within a LocaleProvider");return e}},5272:(e,t,s)=>{var a={"./en.json":[9373,373],"./zh-TW.json":[9032,32]};function r(e){if(!s.o(a,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=a[e],r=t[0];return s.e(t[1]).then(()=>s.t(r,19))}r.keys=()=>Object.keys(a),r.id=5272,e.exports=r},5334:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>tx});var a=s(5155),r=s(2115),i=s(2473),n=s(2596),l=s(9688);function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.QP)((0,n.$)(t))}function c(e){let{className:t,...s}=e;return(0,a.jsx)(i.bL,{"data-slot":"tabs",className:o("flex flex-col gap-2",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)(i.B8,{"data-slot":"tabs-list",className:o("bg-background text-muted-foreground w-full border-b shadow-sm",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(i.l9,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-primary data-[state=active]:text-primary-foreground text-muted-foreground inline-flex h-14 items-center justify-center gap-2 px-8 py-4 text-sm font-medium whitespace-nowrap transition-all hover:text-foreground hover:bg-muted/80 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 relative after:absolute after:bottom-0 after:left-0 after:right-0 after:h-1 after:bg-transparent data-[state=active]:after:bg-primary",t),...s})}function m(e){let{className:t,...s}=e;return(0,a.jsx)(i.UC,{"data-slot":"tabs-content",className:o("flex-1 outline-none",t),...s})}var u=s(9708),f=s(2085);let x=(0,f.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function p(e){let{className:t,variant:s,size:r,asChild:i=!1,...n}=e,l=i?u.DX:"button";return(0,a.jsx)(l,{"data-slot":"button",className:o(x({variant:s,size:r,className:t})),...n})}var g=s(1284),v=s(9074),y=s(381),j=s(2525),b=s(7580),S=s(3052),N=s(2355);function w(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function E(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function C(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",t),...s})}function k(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:o("px-6",t),...s})}var D=s(1522),A=s(6474),P=s(5196),T=s(7863);function _(e){let{...t}=e;return(0,a.jsx)(D.bL,{"data-slot":"select",...t})}function I(e){let{...t}=e;return(0,a.jsx)(D.WT,{"data-slot":"select-value",...t})}function M(e){let{className:t,size:s="default",children:r,...i}=e;return(0,a.jsxs)(D.l9,{"data-slot":"select-trigger","data-size":s,className:o("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[r,(0,a.jsx)(D.In,{asChild:!0,children:(0,a.jsx)(A.A,{className:"size-4 opacity-50"})})]})}function R(e){let{className:t,children:s,position:r="popper",...i}=e;return(0,a.jsx)(D.ZL,{children:(0,a.jsxs)(D.UC,{"data-slot":"select-content",className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...i,children:[(0,a.jsx)(L,{}),(0,a.jsx)(D.LM,{className:o("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(z,{})]})})}function O(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(D.q7,{"data-slot":"select-item",className:o("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(D.VF,{children:(0,a.jsx)(P.A,{className:"size-4"})})}),(0,a.jsx)(D.p4,{children:s})]})}function L(e){let{className:t,...s}=e;return(0,a.jsx)(D.PP,{"data-slot":"select-scroll-up-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(T.A,{className:"size-4"})})}function z(e){let{className:t,...s}=e;return(0,a.jsx)(D.wn,{"data-slot":"select-scroll-down-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(A.A,{className:"size-4"})})}var F=s(4616),U=s(646),V=s(9428);let H=(e,t)=>e<0||e>11||!t?0:new Date(t,e+1,0).getDate(),W=(e,t)=>e<0||e>11?"":t("months.".concat(e))||"",Y=(e,t)=>new Date(t,e,1).getDay(),B=(e,t,s)=>{let a=new Date(s,t,e).getDay();return 0===a||6===a};var G=s(6671),K=s(7652);let q=e=>{let{schedules:t,activeScheduleId:s,onScheduleSelect:i,onScheduleAdd:n,onScheduleDelete:l}=e,[o,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),[f,x]=(0,r.useState)("auto"),g=(0,K.c3)(),y=s&&!o,b=new Date,S=b.getMonth(),N=b.getFullYear(),D=()=>{if(0===t.length)return null;let e=t[0];for(let s=1;s<t.length;s++){let a=t[s];(a.year>e.year||a.year===e.year&&a.month>e.month)&&(e=a)}return e},A=()=>{let e=D();if(!e)return{month:S,year:N};let t=new Date(e.year,e.month),s=new Date(t.getFullYear(),t.getMonth()+1);return{month:s.getMonth(),year:s.getFullYear()}},P=(e,t,s)=>{l(e),G.oR.success(g("toast.scheduleDeleted"),{description:g("toast.scheduleDeletedDescription",{month:W(t,g),year:s})})},T=[...t].sort((e,t)=>t.year-e.year||t.month-e.month),L=Array.from({length:12},(e,t)=>({value:t.toString(),label:g("months.".concat(t))})),z=Array.from({length:10},(e,t)=>{let s=b.getFullYear()-2+t;return{value:s.toString(),label:s.toString()}});return(0,a.jsxs)(w,{children:[(0,a.jsxs)(E,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-5 h-5"}),g("scheduleHistory.title"),y&&s&&(0,a.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["-"," ",(()=>{let e=t.find(e=>e.id===s);return e?"".concat(W(e.month,g)," ").concat(e.year):""})()]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[y&&(0,a.jsx)(p,{variant:"ghost",size:"sm",onClick:()=>i(null),className:"flex items-center gap-2",children:g("scheduleHistory.showAll")}),(0,a.jsxs)(p,{onClick:()=>{let{month:e,year:t}=A();c(!0),h(e),u(t),x("auto")},size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)(F.A,{className:"w-4 h-4"}),g("scheduleHistory.addSchedule")]})]})]}),0===t.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:g("scheduleHistory.noSchedulesYet")})]}),!y&&(0,a.jsxs)(k,{className:"space-y-4",children:[o&&(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50 space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:g("scheduleHistory.createNewSchedule")}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:g("scheduleHistory.month")}),(0,a.jsxs)(_,{value:(null==d?void 0:d.toString())||"",onValueChange:e=>h(parseInt(e)),children:[(0,a.jsx)(M,{children:(0,a.jsx)(I,{placeholder:g("scheduleHistory.selectMonth")})}),(0,a.jsx)(R,{children:L.map(e=>(0,a.jsx)(O,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:g("scheduleHistory.year")}),(0,a.jsxs)(_,{value:(null==m?void 0:m.toString())||"",onValueChange:e=>u(parseInt(e)),children:[(0,a.jsx)(M,{children:(0,a.jsx)(I,{placeholder:g("scheduleHistory.selectYear")})}),(0,a.jsx)(R,{children:z.map(e=>(0,a.jsx)(O,{value:e.value,children:e.label},e.value))})]})]})]}),t.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:g("scheduleHistory.employeeImport")}),(0,a.jsxs)(_,{value:f,onValueChange:x,children:[(0,a.jsx)(M,{children:(0,a.jsx)(I,{placeholder:g("scheduleHistory.chooseImportOption")})}),(0,a.jsxs)(R,{children:[(0,a.jsx)(O,{value:"auto",children:g("scheduleHistory.autoImportFromRecent")}),(0,a.jsx)(O,{value:"none",children:g("scheduleHistory.startWithEmptyList")}),T.map(e=>(0,a.jsxs)(O,{value:e.id,children:[g("scheduleHistory.copyFrom")," ",W(e.month,g)," ",e.year," (",e.employees.length," ",g("scheduleHistory.employees"),")"]},e.id))]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:g("scheduleHistory.importNote")})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p,{onClick:()=>{if(!d||!m)return void G.oR.error(g("toast.invalidInput"),{description:g("toast.selectBothMonthYear")});try{let e;if("auto"===f){let t=D();e=null==t?void 0:t.id}else"none"!==f&&(e=f);n(d,m,e),c(!1),h(null),u(null),x("auto");let t=e?g("toast.withImportedEmployees"):g("toast.withEmptyEmployeeList");G.oR.success(g("toast.scheduleCreated"),{description:g("toast.scheduleCreatedDescription",{month:W(d,g),year:m,importMessage:t})})}catch(e){G.oR.error(g("toast.creationFailed"),{description:e instanceof Error?e.message:g("toast.creationFailedDescription")})}},size:"sm",children:g("scheduleHistory.createSchedule")}),(0,a.jsx)(p,{variant:"outline",onClick:()=>{c(!1),h(null),u(null),x("auto")},size:"sm",children:g("scheduleHistory.cancel")})]})]}),T.length>0&&(0,a.jsx)("div",{className:"space-y-2",children:T.map(e=>(0,a.jsxs)("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors ".concat(e.id===s?"bg-primary/10 border-primary":"hover:bg-muted/50"),onClick:()=>{e.id===s?i(null):i(e.id)},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.isGenerated?(0,a.jsx)(U.A,{className:"w-4 h-4 text-green-600"}):(0,a.jsx)(V.A,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("span",{className:"font-medium",children:[W(e.month,g)," ",e.year]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.employees.length," ",g("scheduleHistory.employees")]}),(0,a.jsx)(p,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),P(e.id,e.month,e.year)},className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-destructive/10",children:(0,a.jsx)(j.A,{className:"w-3 h-3"})})]})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[g("scheduleHistory.created")," ",e.createdAt.toLocaleDateString(),e.isGenerated&&(0,a.jsxs)("span",{className:"ml-2 text-green-600",children:["• ",g("scheduleHistory.generated")]})]})]},e.id))})]})]})};function J(e){let{className:t,type:s,...r}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:o("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}var X=s(968);function Q(e){let{className:t,...s}=e;return(0,a.jsx)(X.b,{"data-slot":"label",className:o("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}let Z=(0,f.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function $(e){let{className:t,variant:s,asChild:r=!1,...i}=e,n=r?u.DX:"span";return(0,a.jsx)(n,{"data-slot":"badge",className:o(Z({variant:s}),t),...i})}var ee=s(4073);let et=r.forwardRef((e,t)=>{let{className:s,label:i,labelPosition:n="top",...l}=e,c=Array.isArray(l.value)?l.value:Array.isArray(l.defaultValue)?l.defaultValue:[l.min||0,l.max||100],[d,h]=r.useState(c);return r.useEffect(()=>{Array.isArray(l.value)&&h(l.value)},[l.value]),(0,a.jsxs)(ee.bL,{ref:t,className:o("relative flex w-full touch-none select-none items-center",s),...l,value:d,onValueChange:e=>{h(e),l.onValueChange&&l.onValueChange(e)},children:[(0,a.jsx)(ee.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(ee.Q6,{className:"absolute h-full bg-primary"})}),d.map((e,t)=>(0,a.jsx)(r.Fragment,{children:(0,a.jsx)(ee.zi,{className:"block h-4 w-4 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:i&&(0,a.jsx)("span",{className:o("absolute flex w-full justify-center","top"===n&&"-top-7","bottom"===n&&"top-4"),children:i(e)})})},t))]})});et.displayName="DualRangeSlider";let es=e=>{let{employee:t,isSelected:s,isEditing:i,predefinedTags:n,onEmployeeSelect:l,onRemoveEmployee:o,onUpdateEmployee:c,onToggleTag:d,onStartEditing:h,onStopEditing:m}=e,[u,f]=(0,r.useState)(""),[x,g]=(0,r.useState)([0,0]),[v,y]=(0,r.useState)([0,0]),[b,S]=(0,r.useState)([0,0]),N=(0,K.c3)(),w=()=>{f(t.name),g(t.shiftsPerMonth),y(t.weekdayShifts),S(t.weekendShifts),h(t)};return(0,a.jsx)("div",{className:"border rounded-lg transition-colors ".concat(s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:i?(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(Q,{htmlFor:"editName",className:"mb-1",children:N("employees.name")}),(0,a.jsx)(J,{id:"editName",value:u,onChange:e=>f(e.target.value),placeholder:N("employees.namePlaceholder")})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:N("employees.shiftsRangeNote")}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Q,{className:"mb-2",children:N("employees.minMaxShiftsPerMonth")}),(0,a.jsx)("div",{className:"px-3 mb-8",children:(0,a.jsx)(et,{value:x,onValueChange:e=>g(e),max:31,min:0,step:1,className:"w-full",label:e=>null==e?void 0:e.toString(),labelPosition:"bottom"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Q,{className:"mb-2",children:N("employees.minMaxWeekdayShifts")}),(0,a.jsx)("div",{className:"px-3 mb-8",children:(0,a.jsx)(et,{value:v,onValueChange:e=>y(e),max:23,min:0,step:1,className:"w-full",label:e=>null==e?void 0:e.toString(),labelPosition:"bottom"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Q,{className:"mb-2",children:N("employees.minMaxWeekendShifts")}),(0,a.jsx)("div",{className:"px-3 mb-8",children:(0,a.jsx)(et,{value:b,onValueChange:e=>S(e),max:9,min:0,step:1,className:"w-full",label:e=>null==e?void 0:e.toString(),labelPosition:"bottom"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Q,{children:N("employees.tags")}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:n.map(e=>{let s=t.tags.includes(e);return(0,a.jsx)(p,{variant:s?"default":"outline",size:"sm",onClick:()=>d(t.id,e),children:N(e)},e)})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p,{onClick:()=>{c(t.id,{name:u,shiftsPerMonth:x,weekdayShifts:v,weekendShifts:b}),m()},size:"sm",children:N("employees.save")}),(0,a.jsx)(p,{onClick:m,variant:"outline",size:"sm",children:N("employees.cancel")}),(0,a.jsxs)(p,{onClick:()=>{o(t.id),m()},variant:"destructive",size:"sm",children:[(0,a.jsx)(j.A,{className:"w-4 h-4 mr-1"}),N("employees.delete")]})]})]}):(0,a.jsx)("div",{className:"p-3 cursor-pointer",onClick:()=>l(s?"":t.id),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:t.name}),(0,a.jsx)($,{variant:"secondary",children:t.shiftsPerMonth[0]===t.shiftsPerMonth[1]?"".concat(t.shiftsPerMonth[0]," ").concat(N("employees.shifts")):"".concat(t.shiftsPerMonth[0],"-").concat(t.shiftsPerMonth[1]," ").concat(N("employees.shifts"))})]}),t.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:t.tags.map(e=>(0,a.jsx)($,{variant:"outline",className:"text-xs",children:N(e)},N(e)))}),s&&(0,a.jsx)("div",{className:"mt-2 text-xs text-blue-600",children:N("employees.selectedDescription")})]}),(0,a.jsx)(p,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),w()},children:N("employees.edit")})]})})})},ea=e=>{let{employees:t,selectedEmployee:s,onEmployeeSelect:i,onAddEmployee:n,onRemoveEmployee:l,onUpdateEmployee:o,onToggleTag:c,predefinedTags:d,hasActiveSchedule:h}=e,[m,u]=(0,r.useState)(""),f=(0,K.c3)(),x=e=>{u(e.id)},g=()=>{u("")};return(0,a.jsxs)(w,{className:"flex flex-col min-h-[400px] max-h-[80vh]",children:[(0,a.jsxs)(E,{className:"flex-shrink-0",children:[(0,a.jsx)(C,{children:f("employees.title")}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:f(h?"employees.selectScheduleDescription":"employees.noActiveScheduleDescription")})]}),(0,a.jsx)(k,{className:"flex-1 flex flex-col overflow-hidden",children:h?0===t.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:f("employees.noEmployeesMessage")}),(0,a.jsxs)(p,{onClick:n,children:[(0,a.jsx)(F.A,{className:"w-4 h-4 mr-2"}),f("employees.addFirstEmployee")]})]}):(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"flex-1 space-y-3 overflow-y-auto pr-2",children:t.map(e=>(0,a.jsx)(es,{employee:e,isSelected:s===e.id,isEditing:m===e.id,predefinedTags:d,onEmployeeSelect:i,onRemoveEmployee:l,onUpdateEmployee:o,onToggleTag:c,onStartEditing:x,onStopEditing:g},e.id))}),h&&(0,a.jsxs)(p,{onClick:n,variant:"outline",className:"w-full mt-3 flex-shrink-0",children:[(0,a.jsx)(F.A,{className:"w-4 h-4 mr-2"}),f("employees.addEmployee")]})]}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:f("employees.noActiveScheduleMessage")})})})]})},er=e=>{let{value:t,onChange:s,min:i=0,max:n=100,defaultValue:l=i,id:o,className:c,placeholder:d}=e,[h,m]=(0,r.useState)(t.toString());return(0,r.useEffect)(()=>{m(t.toString())},[t]),(0,a.jsx)(J,{id:o,type:"number",min:i,max:n,value:h,onChange:e=>m(e.target.value),onBlur:()=>{let e=Math.max(i,Math.min(n,Number.parseInt(h)||l));m(e.toString()),e!==t&&s(e)},className:c,placeholder:d})},ei=e=>{let{value:t,onChange:s,defaultValue:i="",id:n,className:l,placeholder:o,type:c="text",maxLength:d,minLength:h}=e,[m,u]=(0,r.useState)(t);return(0,r.useEffect)(()=>{u(t)},[t]),(0,a.jsx)(J,{id:n,type:c,value:m,onChange:e=>u(e.target.value),onBlur:()=>{let e=m.trim();d&&e.length>d&&(e=e.substring(0,d)),h&&e.length<h&&0===e.length&&(e=i),u(e),e!==t&&s(e)},className:l,placeholder:o,maxLength:d})},en="https://scheduler.onino.tw";class el extends Error{constructor(e,t,s){super(e),this.status=t,this.details=s,this.name="ScheduleAPIError"}}class eo extends el{constructor(e){super("Schedule generation timed out after ".concat(e/1e3," seconds")),this.name="ScheduleTimeoutError"}}class ec extends el{constructor(e,t){super("Server error: ".concat(e)),this.status=t,this.name="ScheduleServerError"}}function ed(e){return{id:e.id,name:e.name,shifts_per_month:e.shiftsPerMonth,weekday_shifts:e.weekdayShifts,weekend_shifts:e.weekendShifts,tags:e.tags}}function eh(e){return{id:e.id,employee_id:e.employeeId,type:e.type,date:e.date,shift_index:e.shiftIndex}}async function em(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e4,a=new AbortController,r=setTimeout(()=>a.abort(),s);try{let s=await fetch(e,{...t,signal:a.signal,headers:{"Content-Type":"application/json",...t.headers}});if(clearTimeout(r),!s.ok){let e="HTTP ".concat(s.status,": ").concat(s.statusText);try{let t=await s.json();t.detail&&(e=Array.isArray(t.detail)?t.detail.map(e=>"object"==typeof e&&e.msg?e.msg:String(e)).join(", "):t.detail)}catch(e){}throw new ec(e,s.status)}return await s.json()}catch(e){if(clearTimeout(r),e instanceof DOMException&&"AbortError"===e.name)throw new eo(s);if(e instanceof el)throw e;throw new el("Network error: ".concat(e instanceof Error?e.message:"Unknown error"))}}async function eu(){return em("".concat(en,"/health"),{method:"GET"})}async function ef(){return em("".concat(en,"/api/v1/solver/status"),{method:"GET"})}async function ex(e,t,s,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:30,n={employees:e.map(ed),constraints:t.map(eh),settings:{shifts_per_day:s.shiftsPerDay,persons_per_shift:s.personsPerShift,max_consecutive_shifts:s.maxConsecutiveShifts,max_consecutive_days:s.maxConsecutiveDays,min_rest_days_between_shifts:s.minRestDaysBetweenShifts,prevent_multiple_shifts_per_day:s.preventMultipleShiftsPerDay,max_shifts_per_week:s.maxShiftsPerWeek,min_shifts_per_week:s.minShiftsPerWeek,even_distribution:s.evenDistribution,fairness_weight:1,preference_weight:.5,optimize_for:"balanced"},selected_month:a,selected_year:r,timeout:i},l=await em("".concat(en,"/api/v1/schedule/generate"),{method:"POST",body:JSON.stringify(n)},(i+5)*1e3);return{schedule:function(e){let t={};for(let[s,a]of Object.entries(e.days))t[parseInt(s)]={shifts:a.shifts.map(e=>({employeeIds:e.employee_ids}))};return t}(l.schedule),success:l.success,message:l.message,metadata:l.metadata}}async function ep(){let e=Date.now();try{await eu();let t=Date.now()-e;return{available:!0,latency:t}}catch(e){return{available:!1,error:e instanceof Error?e.message:"Unknown error"}}}let eg=()=>{var e;let[t,s]=(0,r.useState)({available:!1}),[a,i]=(0,r.useState)(!1),[n]=(0,r.useState)({baseUrl:en,timeout:3e4,configured:!0}),l=(0,r.useCallback)(async()=>{i(!0);try{let e=await ep();if(e.available){let[t,a]=await Promise.all([eu().catch(e=>{console.warn("Health check failed:",e)}),ef().catch(e=>{console.warn("Solver status check failed:",e)})]);s({available:!0,health:t,solverStatus:a,latency:e.latency,lastChecked:new Date})}else s({available:!1,error:e.error,lastChecked:new Date})}catch(e){s({available:!1,error:e instanceof Error?e.message:"Unknown error",lastChecked:new Date})}finally{i(!1)}},[]);(0,r.useEffect)(()=>{n.configured?l():s({available:!1,error:"API URL not configured",lastChecked:new Date})},[n.configured,l]);let o=(0,r.useCallback)(()=>{if(!n.configured)return"Server URL not configured";if(a)return"Checking server status...";if(!t.available)return t.error||"Server unavailable";if(t.health&&t.solverStatus){let e=t.solverStatus.current_load,s=t.solverStatus.max_concurrent,a=Math.round(e/s*100);return"Server healthy • ".concat(t.latency,"ms • Load: ").concat(e,"/").concat(s," (").concat(a,"%)")}return"Server connected • ".concat(t.latency,"ms")},[n.configured,a,t]),c=(0,r.useCallback)(()=>{if(!n.configured)return"text-yellow-600";if(a)return"text-blue-600";if(!t.available)return"text-red-600";if(t.solverStatus){let e=t.solverStatus.current_load/t.solverStatus.max_concurrent*100;if(e>90)return"text-yellow-600";if(e>70)return"text-orange-600"}return"text-green-600"},[n.configured,a,t]);return{status:t,isChecking:a,config:n,checkConnection:l,getStatusMessage:o,getStatusColor:c,isHealthy:t.available&&!a,canUseCPSAT:t.available&&(null==(e=t.solverStatus)?void 0:e.available)!==!1}};var ev=s(5487),ey=s(3904),ej=s(1539),eb=s(4186);let eS=e=>{let{showDetails:t=!1,className:s=""}=e,{status:r,isChecking:i,config:n,checkConnection:l,getStatusMessage:o,getStatusColor:c,isHealthy:d,canUseCPSAT:h}=eg();return t?(0,a.jsx)(w,{className:"p-4 ".concat(s),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ev.A,{className:"h-5 w-5"}),(0,a.jsx)("h3",{className:"font-semibold",children:"CP-SAT Scheduler Server"})]}),(0,a.jsxs)(p,{variant:"outline",size:"sm",onClick:l,disabled:i,children:[(0,a.jsx)(ey.A,{className:"h-4 w-4 mr-2 ".concat(i?"animate-spin":"")}),"Refresh"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)($,{variant:d?"default":"destructive",className:"text-xs",children:d?"Healthy":"Unavailable"}),(0,a.jsx)("span",{className:"text-sm ".concat(c()),children:o()})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,a.jsxs)("div",{children:["Endpoint: ",n.baseUrl]}),(0,a.jsxs)("div",{children:["Timeout: ",n.timeout/1e3,"s"]}),r.lastChecked&&(0,a.jsxs)("div",{children:["Last checked: ",r.lastChecked.toLocaleTimeString()]})]})]}),d&&r.solverStatus&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(ej.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Performance"})]}),(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:["Latency: ",r.latency,"ms"]}),(0,a.jsxs)("div",{children:["Version: ",r.solverStatus.solver_version]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Load"})]}),(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:["Active: ",r.solverStatus.current_load," / ",r.solverStatus.max_concurrent]}),(0,a.jsxs)("div",{children:["Capacity: ",Math.round((1-r.solverStatus.current_load/r.solverStatus.max_concurrent)*100),"% free"]})]})]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded",children:h?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-700",children:[(0,a.jsx)(ej.A,{className:"h-3 w-3"}),"CP-SAT solver available - will be used automatically for optimal scheduling"]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 text-yellow-700",children:[(0,a.jsx)(eb.A,{className:"h-3 w-3"}),"CP-SAT unavailable - falling back to local genetic/simulated annealing algorithms"]})})]})}):(0,a.jsxs)("div",{className:"flex items-center gap-2 ".concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(ev.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"CP-SAT"})]}),(0,a.jsx)($,{variant:d?"default":"destructive",className:"text-xs",children:d?"Connected":"Offline"}),(0,a.jsx)(p,{variant:"ghost",size:"sm",onClick:l,disabled:i,className:"h-6 w-6 p-0",children:(0,a.jsx)(ey.A,{className:"h-3 w-3 ".concat(i?"animate-spin":"")})})]})},eN=e=>{var t;let{settings:s,onSettingsChange:r}=e,i=(0,K.c3)(),n=(e,t)=>{r({...s,[e]:t})};return(0,a.jsxs)(w,{children:[(0,a.jsxs)(E,{children:[(0,a.jsx)(C,{children:i("constraints.title")}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:i("constraints.description")})]}),(0,a.jsxs)(k,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"shiftsPerDay",children:i("constraints.shiftsPerDay")}),(0,a.jsx)(er,{id:"shiftsPerDay",value:s.shiftsPerDay,onChange:e=>{let t=Array.from({length:e},(e,t)=>s.personsPerShift[t]||1),a=Array.from({length:e},(e,t)=>{var a;return(null==(a=s.shiftLabels)?void 0:a[t])||"Shift ".concat(t+1)});r({...s,shiftsPerDay:e,personsPerShift:t,shiftLabels:a})},min:1,max:3,defaultValue:1}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.shiftsPerDayDescription")})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{children:i("constraints.personsPerShift")}),s.personsPerShift.map((e,t)=>{var r;return(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsxs)(Q,{className:"text-sm w-20",children:[(null==(r=s.shiftLabels)?void 0:r[t])||"Shift ".concat(t+1),":"]}),(0,a.jsx)(er,{value:e,onChange:e=>{let a=[...s.personsPerShift];a[t]=e,n("personsPerShift",a)},min:1,max:10,defaultValue:1,className:"w-20"})]},t)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.personsPerShiftDescription")})]}),s.shiftsPerDay>1&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{children:i("settings.shiftLabels")}),null==(t=s.shiftLabels)?void 0:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsxs)(Q,{className:"text-sm w-20",children:[i("shiftPreferences.shiftLabel",{index:t+1}),":"]}),(0,a.jsx)(ei,{value:e,placeholder:i("settings.shiftLabelPlaceholder",{index:t+1}),onChange:e=>{let a=[...s.shiftLabels||[]];a[t]=e||"Shift ".concat(t+1),n("shiftLabels",a)},className:"flex-1",maxLength:20})]},t)),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("settings.customizeShiftNames")})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:i("constraints.restAndRecovery")}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"maxConsecutive",children:i("constraints.maxConsecutiveShifts")}),(0,a.jsx)(er,{id:"maxConsecutive",value:s.maxConsecutiveShifts,onChange:e=>n("maxConsecutiveShifts",e),min:1,max:7,defaultValue:1}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.maxConsecutiveShiftsDescription")})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"maxConsecutiveDays",children:i("constraints.maxConsecutiveDays")}),(0,a.jsx)(er,{id:"maxConsecutiveDays",value:s.maxConsecutiveDays,onChange:e=>n("maxConsecutiveDays",e),min:1,max:7,defaultValue:3}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.maxConsecutiveDaysDescription")})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"minRestDays",children:i("constraints.minRestDaysBetweenShifts")}),(0,a.jsx)(er,{id:"minRestDays",value:s.minRestDaysBetweenShifts,onChange:e=>n("minRestDaysBetweenShifts",e),min:0,max:4,defaultValue:0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.minRestDaysBetweenShiftsDescription")})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Q,{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:s.preventMultipleShiftsPerDay,onChange:e=>n("preventMultipleShiftsPerDay",e.target.checked),className:"rounded"}),i("constraints.preventMultipleShiftsPerDay")]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.preventMultipleShiftsPerDayDescription")})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:i("constraints.weeklyLimits")}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"minShiftsPerWeek",children:i("constraints.minShiftsPerWeek")}),(0,a.jsx)(er,{id:"minShiftsPerWeek",value:s.minShiftsPerWeek,onChange:e=>n("minShiftsPerWeek",e),min:0,max:7,defaultValue:0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.minShiftsPerWeekDescription")})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"maxShiftsPerWeek",children:i("constraints.maxShiftsPerWeek")}),(0,a.jsx)(er,{id:"maxShiftsPerWeek",value:s.maxShiftsPerWeek,onChange:e=>n("maxShiftsPerWeek",e),min:1,max:7,defaultValue:1}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.maxShiftsPerWeekDescription")})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:i("constraints.fairnessAndDistribution")}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Q,{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:s.evenDistribution,onChange:e=>n("evenDistribution",e.target.checked),className:"rounded"}),i("constraints.evenShiftDistribution")]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:i("constraints.evenShiftDistributionDescription")})]})})]}),(0,a.jsxs)("div",{className:"border-t pt-6 bg-muted/50 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:i("constraints.constraintSummary")}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("constraints.daily"),":"]})," ",i("constraints.dailySummary",{shiftsPerDay:s.shiftsPerDay,personsPerShift:s.personsPerShift.join(i("constraints.separator"))})]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("constraints.consecutive"),":"]})," ",i("constraints.consecutiveSummary",{maxShifts:s.maxConsecutiveShifts,maxDays:s.maxConsecutiveDays})]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("constraints.rest"),":"]})," ",i("constraints.restSummary",{days:s.minRestDaysBetweenShifts})]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("constraints.multipleShifts"),":"]})," ",s.preventMultipleShiftsPerDay?i("constraints.prevented"):i("constraints.allowed")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("constraints.weekly"),":"]})," ",i("constraints.weeklySummary",{minShifts:s.minShiftsPerWeek,maxShifts:s.maxShiftsPerWeek})]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("constraints.distribution"),":"]})," ",s.evenDistribution?i("constraints.even"):i("constraints.flexible")]})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Scheduling Algorithm"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{htmlFor:"preferredAlgorithm",children:"Preferred Algorithm"}),(0,a.jsxs)(_,{value:s.preferredAlgorithm,onValueChange:e=>n("preferredAlgorithm",e),children:[(0,a.jsx)(M,{children:(0,a.jsx)(I,{placeholder:"Select algorithm"})}),(0,a.jsxs)(R,{children:[(0,a.jsx)(O,{value:"auto",children:"Auto (Recommended)"}),(0,a.jsx)(O,{value:"cp-sat",children:"CP-SAT Solver (Best Quality)"}),(0,a.jsx)(O,{value:"genetic",children:"Genetic Algorithm (Fast)"}),(0,a.jsx)(O,{value:"simulated-annealing",children:"Simulated Annealing (Simple)"})]})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Auto:"})," Uses CP-SAT if available, falls back to genetic/simulated annealing"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"CP-SAT:"})," Google's constraint programming solver - highest quality results"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Genetic:"})," Good for complex multi-shift schedules"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Simulated Annealing:"})," Simple algorithm for basic single-shift schedules"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{children:"Server Status"}),(0,a.jsx)(eS,{showDetails:!0})]})]})]})]})]})};var ew=s(5112),eE=s(5968),eC=s(2713);let ek={calendar:{type:"calendar",label:"Calendar View",icon:v.A,description:"Traditional calendar layout showing days and shifts",supportsConstraints:!0},spreadsheet:{type:"spreadsheet",label:"Spreadsheet View",icon:ew.A,description:"Employee rows \xd7 day columns with shift assignments",supportsConstraints:!1},list:{type:"list",label:"List View",icon:eE.A,description:"Simple list of employee assignments",supportsConstraints:!1},gantt:{type:"gantt",label:"Timeline View",icon:eC.A,description:"Gantt chart showing employee schedules over time",supportsConstraints:!1}},eD=["calendar","spreadsheet"],eA=(e,t,s,a,r,i)=>{let n=H(s,a),l="Date,Shift,Employee\n";for(let r=1;r<=n;r++){let n=e[r],o="".concat(a,"-").concat((s+1).toString().padStart(2,"0"),"-").concat(r.toString().padStart(2,"0"));(null==n?void 0:n.shifts)&&n.shifts.length>0?n.shifts.forEach((e,s)=>{var a;let r=(null==i||null==(a=i.shiftLabels)?void 0:a[s])||"Shift ".concat(s+1);e.employeeIds.length>0?e.employeeIds.forEach(e=>{let s=t.find(t=>t.id===e);l+="".concat(o,",").concat(r,",").concat((null==s?void 0:s.name)||"Unknown","\n")}):l+="".concat(o,",").concat(r,",No Assignment\n")}):l+="".concat(o,",No Shifts,No Assignment\n")}let o=new Blob([l],{type:"text/csv"}),c=window.URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download="schedule-".concat(W(s,r),"-").concat(a,".csv"),d.click(),window.URL.revokeObjectURL(c)},eP=(e,t,s,a,r,i)=>{let n=document.createElement("canvas"),l=n.getContext("2d");if(!l)return;let o=H(s,a),c=(null==i?void 0:i.shiftsPerDay)&&i.shiftsPerDay>1?60:40;n.width=980,n.height=60+Math.ceil(o/7)*c,l.fillStyle="#ffffff",l.fillRect(0,0,n.width,n.height),l.fillStyle="#000000",l.font="bold 24px Arial",l.textAlign="center",l.fillText("".concat(W(s,r)," ").concat(a," Schedule"),n.width/2,30),l.font="14px Arial",l.textAlign="left";for(let s=1;s<=o;s++){let a=Math.floor((s-1)/7),r=(s-1)%7*140,n=60+a*c;l.strokeStyle="#cccccc",l.strokeRect(r,n,140,c),l.fillStyle="#000000",l.fillText(s.toString(),r+5,n+20);let o=e[s];if((null==o?void 0:o.shifts)&&o.shifts.length>0){let e=35;o.shifts.forEach((s,a)=>{if(s.employeeIds.length>0){if((null==i?void 0:i.shiftsPerDay)&&i.shiftsPerDay>1){var n;let t=(null==(n=i.shiftLabels)?void 0:n[a])||"S".concat(a+1);l.fillStyle="#666666",l.font="10px Arial",l.fillText("".concat(t,":"),r+5,e),e+=12}s.employeeIds.slice(0,2).forEach(s=>{let a=t.find(e=>e.id===s);l.fillStyle="#0066cc",l.font="10px Arial";let i=(null==a?void 0:a.name)||"Unknown",n=i.length>12?i.substring(0,10)+"...":i;l.fillText(n,r+5,e),e+=10}),s.employeeIds.length>2&&(l.fillStyle="#888888",l.font="8px Arial",l.fillText("+".concat(s.employeeIds.length-2," more"),r+5,e),e+=10)}})}}n.toBlob(e=>{if(e){let t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download="schedule-".concat(W(s,r),"-").concat(a,".png"),i.click(),window.URL.revokeObjectURL(t)}})},eT=e=>{let{currentView:t,onViewChange:s}=e;return(0,a.jsx)("div",{className:"flex items-center gap-1 bg-muted p-1 rounded-lg",children:eD.map(e=>{let r=ek[e],i=r.icon;return(0,a.jsx)(p,{variant:t===e?"default":"ghost",size:"sm",onClick:()=>s(e),className:"flex items-center gap-2",title:r.description,children:(0,a.jsx)(i,{className:"w-4 h-4"})},e)})})};var e_=s(3127),eI=s(4261),eM=s(2118);let eR=e=>{let{hasScheduleData:t,settings:s,showShiftColors:i,onToggleShiftColors:n,onExportCSV:l,onExportImage:o}=e,[c,d]=(0,r.useState)(!1),h=(0,r.useRef)(null),m=(0,K.c3)();return(0,r.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s.shiftsPerDay>1&&(0,a.jsx)(p,{variant:i?"default":"outline",size:"sm",onClick:n,className:"flex items-center gap-2",title:m(i?"scheduleView.hideShiftColors":"scheduleView.showShiftColors"),children:(0,a.jsx)(e_.A,{className:"w-4 h-4"})}),t&&(0,a.jsxs)("div",{className:"relative",ref:h,children:[(0,a.jsxs)(p,{variant:"outline",size:"sm",onClick:()=>d(!c),className:"flex items-center gap-2",children:[m("schedule.export"),(0,a.jsx)(A.A,{className:"w-4 h-4"})]}),c&&(0,a.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:[(0,a.jsxs)("button",{onClick:()=>{l(),d(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,a.jsx)(eI.A,{className:"w-4 h-4"}),m("schedule.exportCSV")]}),(0,a.jsxs)("button",{onClick:()=>{o(),d(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,a.jsx)(eM.A,{className:"w-4 h-4"}),m("schedule.exportImage")]})]})]})]})},eO=e=>{let{day:t,daySchedule:s,employees:r,constraints:i,selectedEmployee:n,settings:l,isLastInRow:c,isInLastRow:d,showShiftColors:h=!1,onShiftClick:m,onDayClick:u}=e,f=(0,K.c3)(),x=n?i.filter(e=>e.employeeId===n&&e.date===t):[],p=null;if(x.length>0){let e=x.every(e=>"prefer"===e.type),t=x.every(e=>"avoid"===e.type);e?p="prefer":t&&(p="avoid")}let g=["p-1 min-h-24 border-gray-400 transition-colors"];return c||g.push("border-r"),d||g.push("border-b"),(0,a.jsxs)("div",{className:o(g),children:[(0,a.jsxs)("div",{className:"mb-1 relative flex justify-center items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:t}),n&&l.shiftsPerDay>1&&(0,a.jsx)("button",{onClick:()=>u(t),className:o(["absolute right-0 text-[10px] border transition-colors truncate max-w-[calc(50%-0.5rem)]","constraint-button-".concat(p)]),title:f("scheduleView.setAllShiftsDescription"),children:f("scheduleView.setAllShifts_".concat(p))})]}),(0,a.jsx)("div",{className:"space-y-0.5",children:Array.from({length:l.shiftsPerDay},(e,i)=>{var c,d;let u=null==s||null==(c=s.shifts)?void 0:c[i],f=(null==u?void 0:u.employeeIds)||[],p=(null==(d=l.shiftLabels)?void 0:d[i])||"Shift ".concat(i+1),g=n?x.find(e=>e.shiftIndex===i):null,v=["text-xs border min-h-6 cursor-pointer transition-colors relative"];return h&&l.shiftsPerDay>1&&v.push("shift-".concat(i)),n&&f.includes(n)&&v.push("ring-2 ring-blue-400"),(0,a.jsxs)("div",{className:o(v),onClick:()=>n&&m(t,i),title:p,children:[g&&(0,a.jsx)("div",{className:"absolute top-0 right-0 z-10",children:(0,a.jsx)("span",{className:o(["text-[8px] px-1 py-1 rounded text-white font-bold shadow-sm","prefer"===g.type?"bg-green-600":"bg-red-600"]),children:"prefer"===g.type?"✓":"✗"})}),(0,a.jsx)("div",{className:"space-y-0.5 grid grid-cols-[repeat(auto-fit,minmax(60px,1fr))] gap-0.5",children:f.map((e,s)=>{let l=r.find(t=>t.id===e),c=n===e;return(0,a.jsx)("div",{className:o("text-[12px] truncate",c?"font-bold ring-1 ring-blue-400":""),title:null==l?void 0:l.name,children:null==l?void 0:l.name},"".concat(e,"-").concat(t,"-").concat(i,"-").concat(s))})})]},"".concat(t,"-shift-").concat(i))})})]})},eL=e=>{let{schedule:t,employees:s,selectedMonth:r,selectedYear:i,constraints:n=[],selectedEmployee:l,settings:c,showShiftColors:d,onShiftClick:h,onDayClick:m}=e,u=(0,K.c3)();return(0,a.jsx)("div",{className:"border border-gray-400 rounded-lg overflow-hidden",children:(0,a.jsxs)("div",{className:"grid grid-cols-7",children:[[u("days.0"),u("days.1"),u("days.2"),u("days.3"),u("days.4"),u("days.5"),u("days.6")].map(e=>(0,a.jsx)("div",{className:"p-3 text-center font-medium bg-muted border-r border-b border-gray-400 last:border-r-0",children:e},e)),(()=>{if(!r||!i)return null;let e=Y(r,i),u=H(r,i),f=[],x=e+u;for(let t=0;t<e;t++){let e=(t+1)%7==0,s=t>=7*Math.floor(x/7),r=["p-2 min-h-20 border-gray-400"];e||r.push("border-r"),s||r.push("border-b"),f.push((0,a.jsx)("div",{className:o(r)},"empty-".concat(t)))}for(let r=1;r<=u;r++){let i=t[r],o=e+r-1,u=(o+1)%7==0,p=o>=7*Math.floor(x/7);f.push((0,a.jsx)(eO,{day:r,daySchedule:i,employees:s,constraints:n,selectedEmployee:l,settings:c,isLastInRow:u,isInLastRow:p,showShiftColors:d,onShiftClick:h,onDayClick:m},r))}return f})()]})})},ez=(e,t,s,a,r)=>{let i=H(s,a),n=[];for(let e=1;e<=i;e++){let t=new Date(a,s,e),r=t.toLocaleDateString("en-US",{weekday:"short"}),i=0===t.getDay()||6===t.getDay();n.push({date:e,dayOfWeek:r,isWeekend:i})}let l=[];return t.forEach(t=>{let s=[];for(let a=1;a<=i;a++){let i=e[a],n=[],l=[];(null==i?void 0:i.shifts)&&i.shifts.forEach((e,s)=>{if(e.employeeIds.includes(t.id)){var a;let e=(null==(a=r.shiftLabels)?void 0:a[s])||"Shift ".concat(s+1);n.push(e),l.push(s)}}),s.push({employeeId:t.id,date:a,shifts:n,shiftIndices:l,isEmpty:0===n.length})}l.push(s)}),{employees:t,dateColumns:n,cells:l}},eF=e=>{let{shifts:t,shiftIndices:s,isEmpty:r,showShiftColors:i,isWeekend:n}=e;return r?(0,a.jsx)("div",{className:o("min-h-12 border-r border-b border-gray-300 flex items-center justify-center text-xs text-muted-foreground",n&&"bg-gray-50"),children:"—"}):(0,a.jsx)("div",{className:o("min-h-12 border-r border-b border-gray-300 text-xs flex flex-col",n&&!i&&"bg-gray-50"),children:t.map((e,r)=>(0,a.jsx)("div",{className:o("flex-1 flex items-center justify-center px-1 py-1 text-center font-medium",i&&"shift-".concat(s[r]),!i&&n&&"bg-gray-100 text-gray-800",!i&&!n&&"bg-gray-200 text-gray-800"),style:{minHeight:"".concat(48/t.length,"px")},children:(0,a.jsx)("span",{className:"text-xs leading-tight",children:e})},"".concat(e,"-").concat(r)))})},eU=e=>{let{schedule:t,employees:s,selectedMonth:r,selectedYear:i,settings:n,showShiftColors:l}=e,c=(0,K.c3)();if(0===s.length)return(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:c("employees.noEmployeesMessage")});let d=ez(t,s,r,i,n);return(0,a.jsx)("div",{className:"border border-gray-400 rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("div",{className:"min-w-full",children:[(0,a.jsxs)("div",{className:"grid gap-0",style:{gridTemplateColumns:"120px repeat(".concat(d.dateColumns.length,", 60px)")},children:[(0,a.jsx)("div",{className:"p-3 font-medium bg-muted border-r border-b border-gray-400 sticky left-0 z-10",children:c("employees.title")}),d.dateColumns.map(e=>(0,a.jsxs)("div",{className:o("p-3 text-center font-medium bg-muted border-r border-b border-gray-400 last:border-r-0",e.isWeekend&&"bg-gray-200"),children:[(0,a.jsx)("div",{className:"text-sm font-bold",children:e.date}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.dayOfWeek})]},e.date))]}),d.cells.map((e,t)=>(0,a.jsxs)("div",{className:"grid gap-0",style:{gridTemplateColumns:"120px repeat(".concat(d.dateColumns.length,", 60px)")},children:[(0,a.jsx)("div",{className:"p-3 font-medium border-r border-b border-gray-300 sticky left-0 z-10 bg-white",children:(0,a.jsx)("div",{className:"truncate",title:d.employees[t].name,children:d.employees[t].name})}),e.map((e,t)=>(0,a.jsx)(eF,{shifts:e.shifts,shiftIndices:e.shiftIndices,isEmpty:e.isEmpty,showShiftColors:l,isWeekend:d.dateColumns[t].isWeekend},"".concat(e.employeeId,"-").concat(e.date)))]},d.employees[t].id))]})})})},eV=e=>{let{currentView:t,schedule:s,employees:r,selectedMonth:i,selectedYear:n,constraints:l=[],selectedEmployee:o,settings:c,showShiftColors:d,onSetConstraint:h,onRemoveConstraint:m,onShiftClick:u,onDayClick:f}=e;switch(t){case"calendar":return(0,a.jsx)(eL,{schedule:s,employees:r,selectedMonth:i,selectedYear:n,constraints:l,selectedEmployee:o,settings:c,showShiftColors:d,onSetConstraint:h,onRemoveConstraint:m,onShiftClick:u,onDayClick:f});case"spreadsheet":return(0,a.jsx)(eU,{schedule:s,employees:r,selectedMonth:i,selectedYear:n,settings:c,showShiftColors:d});case"list":case"gantt":return(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[t.charAt(0).toUpperCase()+t.slice(1)," view coming soon..."]});default:return(0,a.jsxs)("div",{className:"text-center py-8 text-red-500",children:["Unknown view type: ",t]})}},eH=e=>{let{settings:t,selectedEmployee:s,showShiftColors:r,onToggleAllShifts:i}=e;return t.shiftsPerDay<=1||!r?null:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground font-medium"}),(0,a.jsx)("div",{className:"flex gap-2 shift-legend",children:Array.from({length:t.shiftsPerDay},(e,r)=>{var n;let l=(null==(n=t.shiftLabels)?void 0:n[r])||"",c=s&&i;return(0,a.jsxs)("div",{className:o("flex items-center gap-1 px-2 py-1 rounded border transition-all","shift-".concat(r),c&&"cursor-pointer hover:scale-105 hover:shadow-sm",!c&&"cursor-default"),onClick:()=>c&&i(r),children:[(0,a.jsx)("div",{className:o("w-3 h-3 rounded border-2","shift-".concat(r))}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-700",children:l})]},r)})})]})},eW=e=>{var t;let{schedule:s,employees:i,selectedMonth:n,selectedYear:l,hasActiveSchedule:o,constraints:c=[],selectedEmployee:d,settings:h,onSetConstraint:m,onRemoveConstraint:u,onToggleAllShifts:f,onGenerateSchedule:x,isGenerating:g=!1}=e,[v,y]=(0,r.useState)("calendar"),[j,b]=(0,r.useState)(!0),S=(0,K.c3)();(0,r.useEffect)(()=>{let e=localStorage.getItem("schedule-view-preference");e&&("calendar"===e||"spreadsheet"===e)&&y(e)},[]);let N=ek[v];return(0,a.jsxs)(w,{children:[(0,a.jsx)(E,{children:(0,a.jsxs)(C,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!o&&S("schedule.title"),o&&S("schedule.monthSchedule",{month:W(n,S),year:l}),d&&N.supportsConstraints&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[S("schedule.settingPreferencesFor")," ",(0,a.jsx)("strong",{children:null==(t=i.find(e=>e.id===d))?void 0:t.name})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(eT,{currentView:v,onViewChange:e=>{y(e),localStorage.setItem("schedule-view-preference",e)}}),(0,a.jsx)(eH,{settings:h,selectedEmployee:d,showShiftColors:j,onToggleAllShifts:f}),x&&(0,a.jsx)(p,{onClick:x,disabled:0===i.length||g,size:"sm",children:g?S("schedule.generating"):S("schedule.generateButton")}),(0,a.jsx)(eS,{}),(0,a.jsx)(eR,{hasScheduleData:Object.keys(s).length>0,settings:h,showShiftColors:j,onToggleShiftColors:()=>b(!j),onExportCSV:()=>{if(0===Object.keys(s).length)return void G.oR.error(S("toast.noSchedule"),{description:S("toast.pleaseGenerateFirst")});try{eA(s,i,n,l,S,h),G.oR.success(S("toast.csvExported"),{description:S("toast.csvExportedDescription")})}catch(e){G.oR.error(S("toast.exportFailed"),{description:S("toast.csvExportFailedDescription")})}},onExportImage:()=>{if(0===Object.keys(s).length)return void G.oR.error(S("toast.noSchedule"),{description:S("toast.pleaseGenerateFirst")});try{eP(s,i,n,l,S,h),G.oR.success(S("toast.imageExported"),{description:S("toast.imageExportedDescription")})}catch(e){G.oR.error(S("toast.exportFailed"),{description:S("toast.imageExportFailedDescription")})}}})]})]})}),(0,a.jsxs)(k,{children:[!o&&(0,a.jsx)("p",{className:"text-muted-foreground",children:S("schedule.noActiveSchedule")}),o&&(0,a.jsx)(eV,{currentView:v,schedule:s,employees:i,selectedMonth:n,selectedYear:l,constraints:c,selectedEmployee:d,settings:h,showShiftColors:j,onSetConstraint:m,onRemoveConstraint:u,onShiftClick:(e,t)=>{if(!d||!m||!u)return;let s=c.find(s=>s.employeeId===d&&s.date===e&&s.shiftIndex===t);s?"avoid"===s.type?m(d,"prefer",e,t):"prefer"===s.type&&u(d,e,t):m(d,"avoid",e,t)},onDayClick:e=>{if(!d||!m||!u)return;let t=c.filter(t=>t.employeeId===d&&t.date===e),s=null;(s=0===t.length?"avoid":t.every(e=>"avoid"===e.type)?"prefer":null)?m(d,s,e):u(d,e)}})]})]})};var eY=s(143),eB=s(4869);let eG={en:{name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8"},"zh-TW":{name:"繁體中文",flag:"\uD83C\uDDF9\uD83C\uDDFC"}};function eK(){let{locale:e,setLocale:t}=(0,eY.Y)();return(0,a.jsxs)(_,{value:e,onValueChange:e=>{t(e)},children:[(0,a.jsx)(M,{className:"w-10 h-10 p-0 border-none hover:bg-muted/50 rounded-md",children:(0,a.jsx)(I,{children:(0,a.jsx)(eB.A,{className:"h-5 w-5"})})}),(0,a.jsxs)(R,{children:[(0,a.jsx)(O,{value:"en",children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:eG.en.flag}),(0,a.jsx)("span",{children:eG.en.name})]})}),(0,a.jsx)(O,{value:"zh-TW",children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:eG["zh-TW"].flag}),(0,a.jsx)("span",{children:eG["zh-TW"].name})]})})]})]})}var eq=s(1368);let eJ={shiftsPerDay:1,personsPerShift:[1],maxConsecutiveShifts:3,maxConsecutiveDays:6,minRestDaysBetweenShifts:0,preventMultipleShiftsPerDay:!0,maxShiftsPerWeek:7,minShiftsPerWeek:0,evenDistribution:!0,shiftLabels:["Shift 1"],preferredAlgorithm:"auto"},eX=()=>{let[e,t]=(0,r.useState)([]),[s,a]=(0,r.useState)(null),[i,n]=(0,r.useState)(eJ),[l,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(),o(!0)},[]),(0,r.useEffect)(()=>{!1!==l&&localStorage.setItem("scheduleData",JSON.stringify({schedules:e,settings:i}))},[e,i,l]);let c=()=>{let e=localStorage.getItem("scheduleData");if(e)try{let s=JSON.parse(e);t((s.schedules||[]).map(e=>({...e,createdAt:new Date(e.createdAt)}))),n({...eJ,...s.settings})}catch(e){console.error("Error loading from localStorage:",e)}},d=(e,s)=>{t(t=>t.map(t=>t.id===e?{...t,...s}:t))},h=()=>e.find(e=>e.id===s)||null,m=h(),u=(null==m?void 0:m.month)||0,f=(null==m?void 0:m.year)||0,x=(null==m?void 0:m.employees)||[],p=(null==m?void 0:m.constraints)||[];return{schedules:e,activeScheduleId:s,setActiveScheduleId:a,addSchedule:(s,r,i)=>{let n=[];if(i){let t=e.find(e=>e.id===i);t&&t.employees.length>0&&(n=t.employees.map(e=>({...e,id:(0,eq.A)()})))}let l={id:(0,eq.A)(),month:s,year:r,employees:n,constraints:[],schedule:{},createdAt:new Date,isGenerated:!1};return t(e=>[...e,l]),a(l.id),l.id},deleteSchedule:e=>{t(t=>t.filter(t=>t.id!==e)),s===e&&a(null)},updateSchedule:d,getActiveSchedule:h,selectedMonth:u,selectedYear:f,employees:x,setEmployees:e=>{s&&d(s,{employees:e})},constraints:p,setConstraints:e=>{s&&d(s,{constraints:e})},schedule:(null==m?void 0:m.schedule)||{},setSchedule:e=>{s&&d(s,{schedule:e,isGenerated:Object.keys(e).length>0})},settings:i,setSettings:n}},eQ=(e,t,s,a,r,i,n)=>({addEmployee:()=>{let s=n?n("employees.newEmployee"):"New Employee",a=(e.length+1).toString().padStart(3,"0"),r={id:(0,eq.A)(),name:"".concat(s," ").concat(a),shiftsPerMonth:[4,8],weekdayShifts:[0,8],weekendShifts:[0,8],tags:[]};t([...e,r]),n?G.oR.success(n("toast.employeeAdded"),{description:n("toast.employeeAddedDescription",{name:r.name})}):G.oR.success("Employee added",{description:"".concat(r.name," has been added to the schedule.")})},removeEmployee:n=>{t(e.filter(e=>e.id!==n)),a(s.filter(e=>e.employeeId!==n));let l={...r};Object.keys(l).forEach(e=>{let t=l[Number.parseInt(e)];t&&t.shifts&&(t.shifts=t.shifts.map(e=>({...e,employeeIds:e.employeeIds.filter(e=>e!==n)})))}),i(l)},updateEmployee:(s,a)=>{t(e.map(e=>e.id===s?{...e,...a}:e)),n?G.oR.success(n("toast.employeeUpdated"),{description:n("toast.employeeUpdatedDescription")}):G.oR.success("Employee updated",{description:"Employee information has been saved."})},toggleEmployeeTag:(s,a)=>{t(e.map(e=>{if(e.id===s){let t=e.tags.includes(a);return{...e,tags:t?e.tags.filter(e=>e!==a):[...e.tags,a]}}return e}))}}),eZ=(e,t)=>({getConstraintsForEmployee:t=>e.filter(e=>e.employeeId===t),getShiftConstraint:(t,s,a)=>e.find(e=>e.employeeId===t&&e.date===s&&e.shiftIndex===a),removeConstraint:(s,a,r)=>{t(e.filter(e=>e.employeeId!==s||e.date!==a||void 0!==r&&e.shiftIndex!==r))},setShiftConstraint:(s,a,r,i)=>{t([...e.filter(e=>e.employeeId!==s||e.date!==r||e.shiftIndex!==i),{id:(0,eq.A)(),employeeId:s,type:a,date:r,shiftIndex:i}])},setAllShiftsConstraint:(s,a,r,i)=>{t([...e.filter(e=>e.employeeId!==s||e.date!==r),...Array.from({length:i},(e,t)=>({id:(0,eq.A)(),employeeId:s,type:a,date:r,shiftIndex:t}))])},setAllDaysConstraints:(s,a,r,i,n)=>{let l=e.filter(e=>!(e.employeeId===s&&r.includes(e.date)&&(void 0===n||e.shiftIndex===n))),o=[];if(a){for(let e of r)if(void 0!==n)o.push({id:(0,eq.A)(),employeeId:s,type:a,date:e,shiftIndex:n});else if(void 0!==i)for(let t=0;t<i;t++)o.push({id:(0,eq.A)(),employeeId:s,type:a,date:e,shiftIndex:t})}t([...l,...o])}}),e$=(e,t)=>e*t.personsPerShift.reduce((e,t)=>e+t,0);var e0=s(2764),e1=s.n(e0);let e2=e=>Math.floor(Math.random()*e),e4=(e,t,s,a)=>{let r=e$(a,s);if(e.length<r)throw Error("Not enough slots in optimized schedule");let i={},n=0;for(let r=1;r<=a;r++){i[r]={shifts:[]};for(let a=0;a<s.shiftsPerDay;a++){let l=[],o=s.personsPerShift[a];for(let s=0;s<o;s++){let s=e[n];if(s>=0&&s<t.length)l.push(t[s].id);else throw Error("Invalid employee index ".concat(s," in optimized schedule"));n++}i[r].shifts.push({employeeIds:l})}}return i},e3=e=>{let t=[];e.forEach((e,s)=>{for(let a=0;a<e.shiftsPerMonth[1];a++)t.push(s)});for(let e=t.length-1;e>0;e--){let s=e2(e+1);[t[e],t[s]]=[t[s],t[e]]}return t},e5=(e,t,s,a,r,i,n)=>{let l=0,o=e$(r,a),c={AVOID_VIOLATION:2e3,DUPLICATE_PERSON_IN_SHIFT:2e3,CONSECUTIVE:100,WEEKLY_LIMIT:100,UNEVEN_DISTRIBUTION:50,MISSED_PREFERENCE:100,REST_DAYS:80,HOLIDAY_DISTRIBUTION:1e3,WEEKEND_CONSECUTIVE:50,TOTAL_SHIFT_COUNT:2e3,WEEKEND_SHIFTS_PREFERENCE:150,WEEKDAY_SHIFTS_PREFERENCE:150},d=Array(t.length).fill(0),h=t.map(()=>({current:0,max:0})),m=Array(t.length).fill(0),u=Array(t.length).fill(0),f=t.map(()=>({current:0,max:0})),x=e.slice(0,o);if(x.length<o)throw Error("Optimized schedule does not have enough slots: expected ".concat(o,", got ").concat(x.length));x.forEach(e=>{if(e<-1||e>=t.length)throw Error("Invalid employee index ".concat(e," in optimized schedule"))});for(let e=0;e<r;e++){let r=e+1,o=e6(r,a),p=x.slice(o.start,o.end);for(let e=0;e<a.shiftsPerDay;e++){let t=e8(r,e,a);new Set(x.slice(t.start,t.end)).size<a.personsPerShift[e]&&(l+=c.DUPLICATE_PERSON_IN_SHIFT)}let g=B(r,i,n);s.forEach(e=>{if(e.date===r){let s=t.findIndex(t=>t.id===e.employeeId);if(-1===s)return;let i=e8(r,e.shiftIndex,a),n=x.slice(i.start,i.end);"avoid"===e.type&&n.includes(s)&&(l+=c.AVOID_VIOLATION),"prefer"!==e.type||n.includes(s)||(l+=c.MISSED_PREFERENCE)}});let v=[...new Set(p)];v.forEach(s=>{var r;if(d[s]++,g?m[s]++:u[s]++,e>0){let t=e6(e,a),r=!1;for(let e=t.start;e<t.end;e++)if(x[e]===s){r=!0;break}r?h[s].current++:h[s].current=1}else h[s].current=1;if(h[s].max=Math.max(h[s].max,h[s].current),g&&(null==(r=t[s])?void 0:r.tags.includes("tags.weekendType"))){if(e>0){let t=B(e,i,n),r=e6(e,a),l=!1;if(t){for(let e=r.start;e<Math.min(r.end,x.length);e++)if(x[e]===s){l=!0;break}}l?f[s].current++:f[s].current=1}else f[s].current=1;f[s].max=Math.max(f[s].max,f[s].current)}else f[s].current=0}),t.forEach((e,t)=>{v.includes(t)||(h[t].current=0,f[t].current=0)})}t.forEach((e,t)=>{let s=0;h[t].max>a.maxConsecutiveShifts&&(s+=(h[t].max-a.maxConsecutiveShifts)*c.CONSECUTIVE),e.tags.includes("tags.weekendType")&&(f[t].max>=2?s=0:s+=c.WEEKEND_CONSECUTIVE),l+=s});let p=t.map(()=>[]);for(let e=0;e<r;e++){let s=e6(e+1,a);t.forEach((t,a)=>{let r=!1;for(let e=s.start;e<s.end&&e<x.length;e++)if(x[e]===a){r=!0;break}r&&p[a].push(e)})}for(let e=0;e<Math.ceil(r/7);e++){let s=7*e,i=Math.min(s+6,r-1);t.forEach((e,t)=>{let r=0;for(let e=s;e<=i;e++)p[t].includes(e)&&r++;r>a.maxShiftsPerWeek&&(l+=(r-a.maxShiftsPerWeek)*c.WEEKLY_LIMIT)})}if(t.forEach((e,t)=>{let s=p[t].sort((e,t)=>e-t);for(let e=0;e<s.length-1;e++){let t=s[e+1]-s[e]-1;t<a.minRestDaysBetweenShifts&&(l+=(a.minRestDaysBetweenShifts-t)*c.REST_DAYS)}}),t.forEach((e,t)=>{let s=d[t];s<e.shiftsPerMonth[0]&&(l+=(e.shiftsPerMonth[0]-s)*c.TOTAL_SHIFT_COUNT),s>e.shiftsPerMonth[1]&&(l+=(s-e.shiftsPerMonth[1])*c.TOTAL_SHIFT_COUNT);let a=m[t],r=u[t];a<e.weekendShifts[0]&&(l+=(e.weekendShifts[0]-a)*c.WEEKEND_SHIFTS_PREFERENCE),a>e.weekendShifts[1]&&(l+=(a-e.weekendShifts[1])*c.WEEKEND_SHIFTS_PREFERENCE),r<e.weekdayShifts[0]&&(l+=(e.weekdayShifts[0]-r)*c.WEEKDAY_SHIFTS_PREFERENCE),r>e.weekdayShifts[1]&&(l+=(r-e.weekdayShifts[1])*c.WEEKDAY_SHIFTS_PREFERENCE)}),a.evenDistribution){let e=d.reduce((e,t)=>e+t,0)/d.length,t=d.reduce((t,s)=>t+Math.pow(s-e,2),0)/d.length;l+=t*c.UNEVEN_DISTRIBUTION}let g=m.reduce((e,t)=>e+t,0),v=u.reduce((e,t)=>e+t,0);return g>0&&v>0&&t.forEach((e,t)=>{let s=d[t];if(s>0){let e=Math.abs(m[t]/s-g/(g+v));m[t]>0&&0===u[t]&&s>1?l+=2*c.HOLIDAY_DISTRIBUTION:u[t]>0&&0===m[t]&&s>1?l+=c.HOLIDAY_DISTRIBUTION:e>.3&&(l+=e*c.HOLIDAY_DISTRIBUTION)}}),console.log("Cost calculated: ".concat(l)),l},e6=(e,t)=>{let s=t.personsPerShift.reduce((e,t)=>e+t,0);return{start:(e-1)*s,end:e*s}},e8=(e,t,s)=>{let a=e6(e,s).start;for(let e=0;e<t;e++)a+=s.personsPerShift[e];return{start:a,end:a+s.personsPerShift[t]}},e7=e=>{let t=[...e];if(t.length<2)return t;let s=["swap","move","reverse","transport"],a=s[e2(s.length)],r=e2(t.length),i=e2(t.length);switch(a){case"swap":[t[r],t[i]]=[t[i],t[r]];break;case"move":{let e=t.splice(r,1)[0];t.splice(i,0,e);break}case"reverse":{let e=Math.min(r,i),s=Math.max(r,i);for(;e<s;)[t[e],t[s]]=[t[s],t[e]],e++,s--;break}case"transport":{if(t.length<3)break;let e=Math.min(r,i),s=Math.max(r,i);if(e<s){let a=t.splice(e,s-e+1),r=e2(t.length);t.splice(r,0,...a)}}}return t},e9=(e,t,s,a,r)=>{if(0===e.length)return{schedule:{},success:!1,message:"Please add employees before generating a schedule."};let i=H(a,r),n=e$(i,s),l=e.reduce((e,t)=>e+t.shiftsPerMonth[0],0),o=e.reduce((e,t)=>e+t.shiftsPerMonth[1],0);if(o<n)return{schedule:{},success:!1,message:"Not enough maximum shifts available (".concat(o,") to cover all required shifts (").concat(n,")")};if(l>n)return{schedule:{},success:!1,message:"Minimum shifts required (".concat(l,") exceed total shifts needed (").concat(n,")")};let c=e3(e);try{console.log("Starting optimized simulated annealing with ".concat(e.length," employees, ").concat(i," days"));let n=Date.now(),l=e1()({initialState:c,tempMax:1e3,tempMin:.1,newState:e=>e7(e),getTemp:e=>.999*e,getEnergy:n=>e5(n,e,t,s,i,a,r)}),o=Date.now();console.log("Simulated annealing completed in ".concat(o-n,"ms"));let d=e4(l,e,s,i),h=e5(l,e,t,s,i,a,r),m=0===h?"Perfect schedule generated with all constraints satisfied!":"Schedule generated with optimization score: ".concat(Math.round(Math.max(0,h)));return{schedule:d,success:!0,message:m}}catch(e){return console.error("Simulated annealing failed:",e),{schedule:{},success:!1,message:"Simulated annealing failed."}}},te={Maximize:(e,t)=>e>=t,Minimize:(e,t)=>e<t},tt={Tournament2(e,t){let s=t.length,a=t[Math.floor(Math.random()*s)],r=t[Math.floor(Math.random()*s)];return e(a.fitness,r.fitness)?a.entity:r.entity},Tournament3(e,t){let s=t.length,a=t[Math.floor(Math.random()*s)],r=t[Math.floor(Math.random()*s)],i=t[Math.floor(Math.random()*s)],n=e(a.fitness,r.fitness)?a:r;return(n=e(n.fitness,i.fitness)?n:i).entity},Fittest:e=>e[0].entity,Random:e=>e[Math.floor(Math.random()*e.length)].entity},ts={Tournament2:(e,t)=>[tt.Tournament2(e,t),tt.Tournament2(e,t)],Random:e=>[tt.Random(e),tt.Random(e)],FittestRandom:e=>[tt.Fittest(e),tt.Random(e)]};function ta(e){return null==e||"object"!=typeof e?e:JSON.parse(JSON.stringify(e))}class tr{mutateOrNot(e){return Math.random()<=this.configuration.mutation&&this.mutate?this.mutate(ta(e)):e}start(){if(!this.fitness||!this.seed)throw Error("fitness and seed functions must be defined");this.select1||(this.select1=e=>tt.Tournament2(this.optimize,e)),this.select2||(this.select2=e=>ts.Tournament2(this.optimize,e)),this.optimize||(this.optimize=te.Minimize);for(let e=0;e<this.configuration.size;++e)this.entities.push(ta(this.seed()));for(let e=0;e<this.configuration.iterations;++e){this.internalGenState={};let t=this.entities.map(e=>({fitness:this.fitness(e),entity:e})).sort((e,t)=>this.optimize(e.fitness,t.fitness)?-1:1),s=t.reduce((e,t)=>e+t.fitness,0)/t.length,a=Math.sqrt(t.map(e=>(e.fitness-s)*(e.fitness-s)).reduce((e,t)=>e+t,0)/t.length),r={maximum:t[0].fitness,minimum:t[t.length-1].fitness,mean:s,stdev:a},i=!this.generation||this.generation(t.slice(0,this.configuration.maxResults),e,r),n=void 0!==i&&!i||e===this.configuration.iterations-1;if(this.notification&&(n||0===this.configuration.skip||e%this.configuration.skip==0)&&this.notification(t.slice(0,this.configuration.maxResults),e,r,n),n)return t[0].entity;let l=[];for(this.configuration.fittestAlwaysSurvives&&l.push(t[0].entity);l.length<this.configuration.size;)if(this.crossover&&Math.random()<=this.configuration.crossover&&l.length+1<this.configuration.size){let e=this.select2(t),s=this.crossover(ta(e[0]),ta(e[1])).map(e=>this.mutateOrNot(e));l.push(s[0],s[1])}else l.push(this.mutateOrNot(this.select1(t)));this.entities=l}return this.entities.map(e=>({fitness:this.fitness(e),entity:e})).sort((e,t)=>this.optimize(e.fitness,t.fitness)?-1:1)[0].entity}async evolve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.configuration,e),new Promise((e,t)=>{try{let t=this.start();e(t)}catch(e){t(e)}})}constructor(){this.fitness=null,this.seed=null,this.mutate=null,this.crossover=null,this.select1=null,this.select2=null,this.optimize=null,this.generation=null,this.notification=null,this.configuration={size:250,crossover:.9,mutation:.2,iterations:100,fittestAlwaysSurvives:!0,maxResults:100,skip:0},this.userData={},this.internalGenState={},this.entities=[]}}let ti={create:()=>new tr,Optimize:te,Select1:tt,Select2:ts},tn=e=>Math.floor(Math.random()*e),tl=(e,t,s,a)=>{if(!e||!Array.isArray(e))throw Error("Invalid genetic schedule provided to optimizedToSchedule");let r={};for(let i=1;i<=a;i++){r[i]={shifts:[]};for(let a=0;a<s.shiftsPerDay;a++){let n=[],l=(i-1)*s.shiftsPerDay+a;if(l<e.length){let s=e[l];for(let e=0;e<s.length;e++)s[e]&&e<t.length&&n.push(t[e].id)}else throw Error("schedule generated is too short");r[i].shifts.push({employeeIds:n})}}return r},to=(e,t,s,a,r,i,n)=>{let l=0,o={MAX_CONSECUTIVE_SHIFTS:100,MAX_CONSECUTIVE_DAYS:100,ENOUGH_REST_DAYS:100,MULTIPLE_SHIFTS_PER_DAY:100,TOTAL_SHIFT_COUNT:100,WEEKDAY_SHIFT_COUNT:100,WEEKEND_SHIFT_COUNT:100,AVOID_VIOLATION:100,PREFER_VIOLATION:10},c=Array(t.length).fill(0),d=t.map(()=>[]),h=t.map(()=>[]),m=Array(t.length).fill(0),u=Array(t.length).fill(0);for(let t=1;t<=r;t++)for(let s=0;s<a.shiftsPerDay;s++){let r=(t-1)*a.shiftsPerDay+s,l=e[r];for(let e=0;e<l.length;e++)l[e]&&(d[e].push(t),h[e].push(r),c[e]++,B(t,i,n)?m[e]++:u[e]++)}return t.forEach((e,t)=>{let s=c[t],r=m[t],i=u[t],n=d[t],f=h[t];s<e.shiftsPerMonth[0]&&(l+=o.TOTAL_SHIFT_COUNT*(e.shiftsPerMonth[0]-s)),s>e.shiftsPerMonth[1]&&(l+=o.TOTAL_SHIFT_COUNT*(s-e.shiftsPerMonth[1])),r<e.weekendShifts[0]&&(l+=o.WEEKDAY_SHIFT_COUNT*(e.weekendShifts[0]-r)),r>e.weekendShifts[1]&&(l+=o.WEEKDAY_SHIFT_COUNT*(r-e.weekendShifts[1])),i<e.weekdayShifts[0]&&(l+=o.WEEKEND_SHIFT_COUNT*(e.weekdayShifts[0]-i)),i>e.weekdayShifts[1]&&(l+=o.WEEKEND_SHIFT_COUNT*(i-e.weekdayShifts[1]));let x=1,p=1,g=n[0],v=f[0];for(let e=1;e<f.length;e++){let t=n[e],s=f[e];s===v+1?++p>a.maxConsecutiveShifts&&(l+=o.MAX_CONSECUTIVE_SHIFTS*(p-a.maxConsecutiveShifts)):p=1,t===g&&a.preventMultipleShiftsPerDay&&(l+=o.MULTIPLE_SHIFTS_PER_DAY),t===g+1?++x>a.maxConsecutiveDays&&(l+=o.MAX_CONSECUTIVE_DAYS*(x-a.maxConsecutiveDays)):t>g+1&&(x=1,t-g-1<a.minRestDaysBetweenShifts&&(l+=o.ENOUGH_REST_DAYS*(g+1+a.minRestDaysBetweenShifts-t)*(g+1+a.minRestDaysBetweenShifts-t))),g=t,v=s}}),s.forEach(s=>{let r=t.findIndex(e=>e.id===s.employeeId);if(-1===r)return;let i=(s.date-1)*a.shiftsPerDay+s.shiftIndex;if(i>=e.length)return;let n=e[i][r];"avoid"===s.type&&n?l+=o.AVOID_VIOLATION:"prefer"!==s.type||n||(l+=o.PREFER_VIOLATION)}),l},tc=(e,t,s)=>{let a=["swap_shift","move_shift","transport_shift","shift_random","shift_random","shift_random"];switch(a[tn(a.length)]){case"swap_shift":{let a=tn(s),r=tn(s),i=tn(t.shiftsPerDay),n=a*t.shiftsPerDay+i,l=r*t.shiftsPerDay+i;[e[n],e[l]]=[e[l],e[n]];break}case"move_shift":{let a=tn(s),r=tn(s),i=e.splice(a*t.shiftsPerDay,t.shiftsPerDay);e.splice(r*t.shiftsPerDay,0,...i);break}case"transport_shift":{let a=tn(s),r=tn(s),i=Math.min(a,r),n=Math.max(a,r),l=e.splice(i*t.shiftsPerDay,(n-i+1)*t.shiftsPerDay),o=tn(s);e.splice(o*t.shiftsPerDay,0,...l);break}case"shift_random":{let t=tn(e.length);for(let s=e[t].length-1;s>0;s--){let a=tn(s+1);[e[t][s],e[t][a]]=[e[t][a],e[t][s]]}}}return e},td=(e,t)=>{let s=e.length;if(s<2)return[e,t];let a=tn(s),r=tn(s);for(;a===r;)r=tn(s);a>r&&([a,r]=[r,a]);let i=[],n=[];for(let l=0;l<s;l++)l<a?(i.push([...e[l]]),n.push([...t[l]])):l<r?(i.push([...t[l]]),n.push([...e[l]])):(i.push([...e[l]]),n.push([...t[l]]));return[i,n]},th=(e,t,s)=>Array.from({length:s},(s,a)=>{let r=t.personsPerShift[a%t.shiftsPerDay],i=Array(r).fill(!0).concat(Array(e.length-r).fill(!1));for(let e=i.length-1;e>0;e--){let t=tn(e+1);[i[e],i[t]]=[i[t],i[e]]}return i}),tm=async(e,t,s,a,r)=>{let i=H(a,r),n=e$(i,s),l=e.reduce((e,t)=>e+t.shiftsPerMonth[0],0),o=e.reduce((e,t)=>e+t.shiftsPerMonth[1],0);if(o<n)return{schedule:{},success:!1,message:"Not enough maximum shifts available (".concat(o,") to cover all required shifts (").concat(n,")")};if(l>n)return{schedule:{},success:!1,message:"Minimum shifts required (".concat(l,") exceed total shifts needed (").concat(n,")")};try{let n=ti.create();n.seed=()=>th(e,s,i*s.shiftsPerDay),n.fitness=n=>to(n,e,t,s,i,a,r),n.mutate=e=>tc(e,s,i),n.crossover=td,n.select1=e=>.9>=Math.random()?ti.Select1.Tournament2(ti.Optimize.Minimize,e):ti.Select1.Fittest(e),n.select2=e=>.9>=Math.random()?ti.Select2.Tournament2(ti.Optimize.Minimize,e):ti.Select2.FittestRandom(e),n.generation=(e,t,s)=>{t%10==0&&console.log("Gen ".concat(t,": best = ").concat(s.maximum," stdev = ").concat(s.stdev));let a=e[0];return 0!==a.fitness};let l={size:10,iterations:3e4,crossover:.5,mutation:.4,maxResults:1,skip:5};console.log("Starting genetic algorithm with config:",l);let o=await Promise.race([n.evolve(l),new Promise((e,t)=>setTimeout(()=>t(Error("Genetic algorithm timeout")),3e4))]),c=tl(o,e,s,i),d=to(o,e,t,s,i,a,r);return{schedule:c,success:!0,message:"Genetic algorithm completed successfully. Final penalty score: ".concat(d)}}catch(e){return console.error("Genetic algorithm error:",e),{schedule:{},success:!1,message:"Genetic algorithm failed: ".concat(e instanceof Error?e.message:"Unknown error")}}},tu=()=>{let[e,t]=(0,r.useState)(!1);return{isGenerating:e,handleGenerateSchedule:async(e,s,a,r,i,n,l)=>{t(!0);try{let t,o=l||a.preferredAlgorithm||"auto";switch("auto"===o&&((await ep()).available?o="cp-sat":(console.log("CP-SAT server not available, falling back to local algorithms"),o=1===a.shiftsPerDay?"simulated-annealing":"genetic")),o){case"cp-sat":console.log("Using CP-SAT solver..."),await new Promise(e=>setTimeout(e,500));try{if(console.log("Using JSON API for CP-SAT..."),(t=await ex(e,s,a,r,i,30)).success&&t.metadata){let{solve_time:e,objective_value:s,constraints_satisfied:a}=t.metadata;t.message+=" (Solved in ".concat(e.toFixed(2),"s, objective: ").concat(s,", constraints: ").concat(a?"all satisfied":"some violated",")")}}catch(n){n instanceof eo?G.oR.error("CP-SAT solver timeout",{description:"The solver took too long. Trying fallback algorithm..."}):n instanceof ec?G.oR.error("CP-SAT server error",{description:"Server issue detected. Trying fallback algorithm..."}):n instanceof el&&G.oR.error("CP-SAT connection error",{description:"Cannot connect to solver. Trying fallback algorithm..."}),console.log("CP-SAT failed, falling back to genetic algorithm:",n),o="genetic",(t=await tm(e,s,a,r,i)).message="Fallback: ".concat(t.message)}break;case"genetic":console.log("Using genetic algorithm..."),await new Promise(e=>setTimeout(e,500)),t=await tm(e,s,a,r,i);break;default:console.log("Using simulated annealing algorithm..."),await new Promise(e=>setTimeout(e,500)),t=e9(e,s,a,r,i)}if(t.success){let e;switch(n(t.schedule),o){case"cp-sat":e="CP-SAT Solver";break;case"genetic":e="Genetic Algorithm";break;default:e="Simulated Annealing"}G.oR.success("Schedule generated with ".concat(e),{description:t.message})}else G.oR.error("Generation failed",{description:t.message})}catch(e){console.error("Schedule generation error:",e),G.oR.error("Generation error",{description:"An unexpected error occurred while generating the schedule."})}finally{t(!1)}}}},tf=()=>{let[e,t]=(0,r.useState)(!1),s=(0,r.useCallback)(()=>{t(e=>!e)},[]);return(0,r.useEffect)(()=>{let e=e=>{e.ctrlKey&&"b"===e.key&&(e.preventDefault(),s())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s]),{isEmployeePanelCollapsed:e,toggleEmployeePanel:s}};function tx(){let e=(0,K.c3)(),{schedules:t,activeScheduleId:s,setActiveScheduleId:i,addSchedule:n,deleteSchedule:l,selectedMonth:u,selectedYear:f,employees:x,setEmployees:w,constraints:E,setConstraints:C,schedule:k,setSchedule:D,settings:A,setSettings:P}=eX(),{addEmployee:T,removeEmployee:_,updateEmployee:I,toggleEmployeeTag:M}=eQ(x,w,E,C,k,D,e),{removeConstraint:R,setShiftConstraint:O,setAllShiftsConstraint:L,setAllDaysConstraints:z}=eZ(E,C),{isGenerating:F,handleGenerateSchedule:U}=tu(),{isEmployeePanelCollapsed:V,toggleEmployeePanel:H}=tf(),[W,Y]=(0,r.useState)("");return(0,a.jsx)("div",{children:(0,a.jsxs)(c,{defaultValue:"about",className:"space-y-0",children:[(0,a.jsx)(d,{className:"w-full",children:(0,a.jsxs)("div",{className:"w-full flex justify-between items-center px-6",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)(h,{value:"about",className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"w-4 h-4"}),"About"]}),(0,a.jsxs)(h,{value:"setup",className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-4 h-4"}),e("page.setup")]}),(0,a.jsxs)(h,{value:"constraints",className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"w-4 h-4"}),e("page.constraints")]})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(eK,{})})]})}),(0,a.jsx)(m,{value:"about",className:"mt-0",children:(0,a.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center max-w-3xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-4",children:e("page.title")}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground leading-relaxed",children:e("page.description")})]}),(0,a.jsx)("div",{className:"border-t pt-6",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-center",children:e("dataManagement.title")}),(0,a.jsxs)("div",{className:"bg-muted/50 rounded-lg p-6 space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e("dataManagement.clearAllDataDescription")}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)(p,{variant:"destructive",onClick:()=>{window.confirm(e("dataManagement.clearAllDataConfirm"))&&(localStorage.removeItem("scheduleData"),localStorage.removeItem("locale"),G.oR.success(e("dataManagement.dataCleared")),window.location.reload())},className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),e("dataManagement.clearAllData")]})})]})]})})]})})}),(0,a.jsx)(m,{value:"setup",className:"mt-0",children:(0,a.jsx)("div",{className:"container mx-auto p-6 transition-all duration-300 max-w-none",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(q,{schedules:t,activeScheduleId:s,onScheduleSelect:i,onScheduleAdd:n,onScheduleDelete:l}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p,{variant:"outline",size:"sm",onClick:H,className:"mb-4 shadow-sm hover:shadow-md transition-all",title:V?"Show employee panel (Ctrl+B)":"Hide employee panel (Ctrl+B)",children:V?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.A,{className:"w-4 h-4 mr-2"}),(0,a.jsx)(S.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"ml-1",children:e("employees.showEmployees")})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"w-4 h-4 mr-2"}),(0,a.jsx)("span",{children:e("employees.hideEmployees")})]})}),(0,a.jsxs)("div",{className:o("transition-all duration-300 ease-in-out",V?"grid grid-cols-1 gap-6":"grid grid-cols-1 xl:grid-cols-4 gap-6"),children:[!V&&(0,a.jsx)("div",{className:"transition-all duration-300",children:(0,a.jsx)(ea,{employees:x,selectedEmployee:W,onEmployeeSelect:Y,onAddEmployee:T,onRemoveEmployee:_,onUpdateEmployee:I,onToggleTag:M,predefinedTags:["tags.weekendType","tags.rookie","tags.veteran"],hasActiveSchedule:null!==s})}),(0,a.jsx)("div",{className:o("transition-all duration-300",V?"col-span-2":"xl:col-span-3"),children:(0,a.jsx)(eW,{schedule:k,employees:x,selectedMonth:u,selectedYear:f,hasActiveSchedule:null!==s,constraints:E,selectedEmployee:W,settings:A,onSetConstraint:(e,t,s,a)=>{void 0===a?L(e,t,s,A.shiftsPerDay):O(e,t,s,a)},onRemoveConstraint:R,onToggleAllShifts:e=>{if(!W)return;let t=E.filter(t=>t.employeeId===W&&t.shiftIndex===e),s=null;z(W,s=0===t.length?"avoid":t.every(e=>"avoid"===e.type)?"prefer":null,Array.from({length:new Date(f,u+1,0).getDate()},(e,t)=>t+1),A.shiftsPerDay,e)},onGenerateSchedule:()=>{U(x,E,A,u,f,D)},isGenerating:F})})]})]})]})})}),(0,a.jsx)(m,{value:"constraints",className:"mt-0",children:(0,a.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(eN,{settings:A,onSettingsChange:P})})})})]})})}},7544:(e,t,s)=>{Promise.resolve().then(s.bind(s,5334))}},e=>{var t=t=>e(e.s=t);e.O(0,[208,88,441,684,358],()=>t(7544)),_N_E=e.O()}]);