(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{18:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eN});var r=s(5155),a=s(2115),n=s(2473),i=s(2596),l=s(9688);function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.QP)((0,i.$)(t))}function d(e){let{className:t,...s}=e;return(0,r.jsx)(n.bL,{"data-slot":"tabs",className:o("flex flex-col gap-2",t),...s})}function c(e){let{className:t,...s}=e;return(0,r.jsx)(n.B8,{"data-slot":"tabs-list",className:o("bg-background text-muted-foreground w-full border-b shadow-sm",t),...s})}function h(e){let{className:t,...s}=e;return(0,r.jsx)(n.l9,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-primary data-[state=active]:text-primary-foreground text-muted-foreground inline-flex h-14 items-center justify-center gap-2 px-8 py-4 text-sm font-medium whitespace-nowrap transition-all hover:text-foreground hover:bg-muted/80 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 relative after:absolute after:bottom-0 after:left-0 after:right-0 after:h-1 after:bg-transparent data-[state=active]:after:bg-primary",t),...s})}function u(e){let{className:t,...s}=e;return(0,r.jsx)(n.UC,{"data-slot":"tabs-content",className:o("flex-1 outline-none",t),...s})}var m=s(1284),x=s(9074),p=s(381);function g(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function f(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function v(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",t),...s})}function j(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:o("px-6",t),...s})}var y=s(9708),b=s(2085);let N=(0,b.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function w(e){let{className:t,variant:s,size:a,asChild:n=!1,...i}=e,l=n?y.DX:"button";return(0,r.jsx)(l,{"data-slot":"button",className:o(N({variant:s,size:a,className:t})),...i})}var S=s(721),k=s(6474),D=s(5196),C=s(7863);function E(e){let{...t}=e;return(0,r.jsx)(S.bL,{"data-slot":"select",...t})}function P(e){let{...t}=e;return(0,r.jsx)(S.WT,{"data-slot":"select-value",...t})}function A(e){let{className:t,size:s="default",children:a,...n}=e;return(0,r.jsxs)(S.l9,{"data-slot":"select-trigger","data-size":s,className:o("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[a,(0,r.jsx)(S.In,{asChild:!0,children:(0,r.jsx)(k.A,{className:"size-4 opacity-50"})})]})}function z(e){let{className:t,children:s,position:a="popper",...n}=e;return(0,r.jsx)(S.ZL,{children:(0,r.jsxs)(S.UC,{"data-slot":"select-content",className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[(0,r.jsx)(M,{}),(0,r.jsx)(S.LM,{className:o("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,r.jsx)(I,{})]})})}function R(e){let{className:t,children:s,...a}=e;return(0,r.jsxs)(S.q7,{"data-slot":"select-item",className:o("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...a,children:[(0,r.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(S.VF,{children:(0,r.jsx)(D.A,{className:"size-4"})})}),(0,r.jsx)(S.p4,{children:s})]})}function M(e){let{className:t,...s}=e;return(0,r.jsx)(S.PP,{"data-slot":"select-scroll-up-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(C.A,{className:"size-4"})})}function I(e){let{className:t,...s}=e;return(0,r.jsx)(S.wn,{"data-slot":"select-scroll-down-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(k.A,{className:"size-4"})})}var F=s(4616),W=s(646),L=s(9428),_=s(2525);let T=(e,t)=>e<0||e>11||!t?0:new Date(t,e+1,0).getDate(),H=(e,t)=>e<0||e>11?"":t("months.".concat(e))||"",O=(e,t)=>new Date(t,e,1).getDay(),U=(e,t,s)=>{let r=new Date(s,t,e).getDay();return 0===r||6===r};var B=s(6671),G=s(7652);let Y=e=>{let{schedules:t,activeScheduleId:s,onScheduleSelect:n,onScheduleAdd:i,onScheduleDelete:l}=e,[o,d]=(0,a.useState)(!1),[c,h]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[p,y]=(0,a.useState)("auto"),b=(0,G.c3)(),N=s&&!o,S=new Date,k=S.getMonth(),D=S.getFullYear(),C=()=>{if(0===t.length)return null;let e=t[0];for(let s=1;s<t.length;s++){let r=t[s];(r.year>e.year||r.year===e.year&&r.month>e.month)&&(e=r)}return e},M=()=>{let e=C();if(!e)return{month:k,year:D};let t=new Date(e.year,e.month),s=new Date(t.getFullYear(),t.getMonth()+1);return{month:s.getMonth(),year:s.getFullYear()}},I=(e,t,s)=>{l(e),B.oR.success(b("toast.scheduleDeleted"),{description:b("toast.scheduleDeletedDescription",{month:H(t,b),year:s})})},T=[...t].sort((e,t)=>t.year-e.year||t.month-e.month),O=Array.from({length:12},(e,t)=>({value:t.toString(),label:b("months.".concat(t))})),U=Array.from({length:10},(e,t)=>{let s=S.getFullYear()-2+t;return{value:s.toString(),label:s.toString()}});return(0,r.jsxs)(g,{children:[(0,r.jsxs)(f,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(v,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"w-5 h-5"}),b("scheduleHistory.title"),N&&s&&(0,r.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["-"," ",(()=>{let e=t.find(e=>e.id===s);return e?"".concat(H(e.month,b)," ").concat(e.year):""})()]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[N&&(0,r.jsx)(w,{variant:"ghost",size:"sm",onClick:()=>n(null),className:"flex items-center gap-2",children:b("scheduleHistory.showAll")}),(0,r.jsxs)(w,{onClick:()=>{let{month:e,year:t}=M();d(!0),h(e),m(t),y("auto")},size:"sm",className:"flex items-center gap-2",children:[(0,r.jsx)(F.A,{className:"w-4 h-4"}),b("scheduleHistory.addSchedule")]})]})]}),0===t.length&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:b("scheduleHistory.noSchedulesYet")})]}),!N&&(0,r.jsxs)(j,{className:"space-y-4",children:[o&&(0,r.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50 space-y-4",children:[(0,r.jsx)("h4",{className:"font-medium",children:b("scheduleHistory.createNewSchedule")}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:b("scheduleHistory.month")}),(0,r.jsxs)(E,{value:(null==c?void 0:c.toString())||"",onValueChange:e=>h(parseInt(e)),children:[(0,r.jsx)(A,{children:(0,r.jsx)(P,{placeholder:b("scheduleHistory.selectMonth")})}),(0,r.jsx)(z,{children:O.map(e=>(0,r.jsx)(R,{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:b("scheduleHistory.year")}),(0,r.jsxs)(E,{value:(null==u?void 0:u.toString())||"",onValueChange:e=>m(parseInt(e)),children:[(0,r.jsx)(A,{children:(0,r.jsx)(P,{placeholder:b("scheduleHistory.selectYear")})}),(0,r.jsx)(z,{children:U.map(e=>(0,r.jsx)(R,{value:e.value,children:e.label},e.value))})]})]})]}),t.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:b("scheduleHistory.employeeImport")}),(0,r.jsxs)(E,{value:p,onValueChange:y,children:[(0,r.jsx)(A,{children:(0,r.jsx)(P,{placeholder:b("scheduleHistory.chooseImportOption")})}),(0,r.jsxs)(z,{children:[(0,r.jsx)(R,{value:"auto",children:b("scheduleHistory.autoImportFromRecent")}),(0,r.jsx)(R,{value:"none",children:b("scheduleHistory.startWithEmptyList")}),T.map(e=>(0,r.jsxs)(R,{value:e.id,children:[b("scheduleHistory.copyFrom")," ",H(e.month,b)," ",e.year," (",e.employees.length," ",b("scheduleHistory.employees"),")"]},e.id))]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:b("scheduleHistory.importNote")})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(w,{onClick:()=>{if(!c||!u)return void B.oR.error(b("toast.invalidInput"),{description:b("toast.selectBothMonthYear")});try{let e;if("auto"===p){let t=C();e=null==t?void 0:t.id}else"none"!==p&&(e=p);i(c,u,e),d(!1),h(null),m(null),y("auto");let t=e?b("toast.withImportedEmployees"):b("toast.withEmptyEmployeeList");B.oR.success(b("toast.scheduleCreated"),{description:b("toast.scheduleCreatedDescription",{month:H(c,b),year:u,importMessage:t})})}catch(e){B.oR.error(b("toast.creationFailed"),{description:e instanceof Error?e.message:b("toast.creationFailedDescription")})}},size:"sm",children:b("scheduleHistory.createSchedule")}),(0,r.jsx)(w,{variant:"outline",onClick:()=>{d(!1),h(null),m(null),y("auto")},size:"sm",children:b("scheduleHistory.cancel")})]})]}),T.length>0&&(0,r.jsx)("div",{className:"space-y-2",children:T.map(e=>(0,r.jsxs)("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors ".concat(e.id===s?"bg-primary/10 border-primary":"hover:bg-muted/50"),onClick:()=>{e.id===s?n(null):n(e.id)},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.isGenerated?(0,r.jsx)(W.A,{className:"w-4 h-4 text-green-600"}):(0,r.jsx)(L.A,{className:"w-4 h-4 text-muted-foreground"}),(0,r.jsxs)("span",{className:"font-medium",children:[H(e.month,b)," ",e.year]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.employees.length," ",b("scheduleHistory.employees")]}),(0,r.jsx)(w,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),I(e.id,e.month,e.year)},className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-destructive/10",children:(0,r.jsx)(_.A,{className:"w-3 h-3"})})]})]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[b("scheduleHistory.created")," ",e.createdAt.toLocaleDateString(),e.isGenerated&&(0,r.jsxs)("span",{className:"ml-2 text-green-600",children:["• ",b("scheduleHistory.generated")]})]})]},e.id))})]})]})};function V(e){let{className:t,type:s,...a}=e;return(0,r.jsx)("input",{type:s,"data-slot":"input",className:o("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a})}var q=s(968);function J(e){let{className:t,...s}=e;return(0,r.jsx)(q.b,{"data-slot":"label",className:o("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}let X=(0,b.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Q(e){let{className:t,variant:s,asChild:a=!1,...n}=e,i=a?y.DX:"span";return(0,r.jsx)(i,{"data-slot":"badge",className:o(X({variant:s}),t),...n})}let Z=e=>{let{employees:t,selectedEmployee:s,onEmployeeSelect:n,onAddEmployee:i,onRemoveEmployee:l,onUpdateEmployee:o,onToggleTag:d,predefinedTags:c,hasActiveSchedule:h}=e,[u,m]=(0,a.useState)(""),[x,p]=(0,a.useState)(""),[y,b]=(0,a.useState)(0),N=(0,G.c3)(),S=e=>{m(e.id),p(e.name),b(e.shiftsPerMonth)},k=()=>{o(u,{name:x,shiftsPerMonth:y}),m("")},D=()=>{m(""),p(""),b(0)};return(0,r.jsxs)(g,{className:"flex flex-col h-[600px]",children:[(0,r.jsxs)(f,{className:"flex-shrink-0",children:[(0,r.jsx)(v,{children:N("employees.title")}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:h?N("employees.selectScheduleDescription"):N("employees.noActiveScheduleDescription")})]}),(0,r.jsx)(j,{className:"flex-1 flex flex-col overflow-hidden",children:h?0===t.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:N("employees.noEmployeesMessage")}),(0,r.jsxs)(w,{onClick:i,children:[(0,r.jsx)(F.A,{className:"w-4 h-4 mr-2"}),N("employees.addFirstEmployee")]})]}):(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,r.jsx)("div",{className:"flex-1 space-y-3 overflow-y-auto pr-2",children:t.map(e=>(0,r.jsx)("div",{className:"border rounded-lg transition-colors ".concat(s===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:u===e.id?(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(J,{htmlFor:"editName",children:N("employees.name")}),(0,r.jsx)(V,{id:"editName",value:x,onChange:e=>p(e.target.value),placeholder:N("employees.namePlaceholder")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(J,{htmlFor:"editShifts",children:N("employees.shiftsPerMonth")}),(0,r.jsx)(V,{id:"editShifts",type:"number",min:"1",max:"31",value:y,onChange:e=>b(Number.parseInt(e.target.value)||0)})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(J,{children:N("employees.tags")}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map(t=>{let s=e.tags.includes(t);return(0,r.jsx)(w,{variant:s?"default":"outline",size:"sm",onClick:()=>d(e.id,t),children:N(t)},t)})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(w,{onClick:k,size:"sm",children:N("employees.save")}),(0,r.jsx)(w,{onClick:D,variant:"outline",size:"sm",children:N("employees.cancel")}),(0,r.jsxs)(w,{onClick:()=>{l(e.id),m("")},variant:"destructive",size:"sm",children:[(0,r.jsx)(_.A,{className:"w-4 h-4 mr-1"}),N("employees.delete")]})]})]}):(0,r.jsx)("div",{className:"p-3 cursor-pointer",onClick:()=>n(s===e.id?"":e.id),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsxs)(Q,{variant:"secondary",children:[e.shiftsPerMonth," ",N("employees.shifts")]})]}),e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.tags.map(e=>(0,r.jsx)(Q,{variant:"outline",className:"text-xs",children:N(e)},N(e)))}),s===e.id&&(0,r.jsx)("div",{className:"mt-2 text-xs text-blue-600",children:N("employees.selectedDescription")})]}),(0,r.jsx)(w,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),S(e)},children:N("employees.edit")})]})})},e.id))}),h&&(0,r.jsxs)(w,{onClick:i,variant:"outline",className:"w-full mt-3 flex-shrink-0",children:[(0,r.jsx)(F.A,{className:"w-4 h-4 mr-2"}),N("employees.addEmployee")]})]}):(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:N("employees.noActiveScheduleMessage")})})})]})},$=e=>{let{settings:t,onSettingsChange:s}=e,a=(0,G.c3)(),n=(e,r)=>{s({...t,[e]:r})};return(0,r.jsxs)(g,{children:[(0,r.jsxs)(f,{children:[(0,r.jsx)(v,{children:a("constraints.title")}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:a("constraints.description")})]}),(0,r.jsxs)(j,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J,{htmlFor:"shiftsPerDay",children:a("constraints.shiftsPerDay")}),(0,r.jsx)(V,{id:"shiftsPerDay",type:"number",min:"1",max:"3",value:t.shiftsPerDay,onChange:e=>n("shiftsPerDay",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.shiftsPerDayDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J,{htmlFor:"personsPerShift",children:a("constraints.personsPerShift")}),(0,r.jsx)(V,{id:"personsPerShift",type:"number",min:"1",max:"10",value:t.personsPerShift,onChange:e=>n("personsPerShift",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.personsPerShiftDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J,{htmlFor:"maxConsecutive",children:a("constraints.maxConsecutiveShifts")}),(0,r.jsx)(V,{id:"maxConsecutive",type:"number",min:"1",max:"7",value:t.maxConsecutiveShifts,onChange:e=>n("maxConsecutiveShifts",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.maxConsecutiveShiftsDescription")})]})]}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:a("constraints.restAndRecovery")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J,{htmlFor:"minRestDays",children:a("constraints.minRestDaysBetweenShifts")}),(0,r.jsx)(V,{id:"minRestDays",type:"number",min:"0",max:"3",value:t.minRestDaysBetweenShifts,onChange:e=>n("minRestDaysBetweenShifts",Number.parseInt(e.target.value)||0)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.minRestDaysBetweenShiftsDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(J,{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.weekendCoverageRequired,onChange:e=>n("weekendCoverageRequired",e.target.checked),className:"rounded"}),a("constraints.weekendCoverageRequired")]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.weekendCoverageRequiredDescription")})]})]})]}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:a("constraints.weeklyLimits")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J,{htmlFor:"minShiftsPerWeek",children:a("constraints.minShiftsPerWeek")}),(0,r.jsx)(V,{id:"minShiftsPerWeek",type:"number",min:"0",max:"7",value:t.minShiftsPerWeek,onChange:e=>n("minShiftsPerWeek",Number.parseInt(e.target.value)||0)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.minShiftsPerWeekDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J,{htmlFor:"maxShiftsPerWeek",children:a("constraints.maxShiftsPerWeek")}),(0,r.jsx)(V,{id:"maxShiftsPerWeek",type:"number",min:"1",max:"7",value:t.maxShiftsPerWeek,onChange:e=>n("maxShiftsPerWeek",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.maxShiftsPerWeekDescription")})]})]})]}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:a("constraints.fairnessAndDistribution")}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(J,{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.evenDistribution,onChange:e=>n("evenDistribution",e.target.checked),className:"rounded"}),a("constraints.evenShiftDistribution")]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.evenShiftDistributionDescription")})]})})]}),(0,r.jsxs)("div",{className:"border-t pt-6 bg-muted/50 p-4 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:a("constraints.constraintSummary")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.daily"),":"]})," ",t.shiftsPerDay," ",a("constraints.shifts"),","," ",t.personsPerShift," ",a("constraints.persons")," ",a("constraints.each")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.consecutive"),":"]})," ",a("constraints.max")," ",t.maxConsecutiveShifts," ",a("constraints.inARow")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.rest"),":"]})," ",t.minRestDaysBetweenShifts," ",a("constraints.dayMinimum")]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.weekly"),":"]})," ",t.minShiftsPerWeek,"-",t.maxShiftsPerWeek," ",a("constraints.shiftsPerPerson")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.weekend"),":"]})," ",a(t.weekendCoverageRequired?"constraints.required":"constraints.optional")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.distribution"),":"]})," ",a(t.evenDistribution?"constraints.even":"constraints.flexible")]})]})]})]})]})]})};var K=s(4261),ee=s(2118);let et=(e,t,s,r,a)=>{let n=T(s,r),i="Date,Employee\n";for(let a=1;a<=n;a++){let n=e[a]||[];n.length>0?n.forEach(e=>{let n=t.find(t=>t.id===e);i+="".concat(r,"-").concat((s+1).toString().padStart(2,"0"),"-").concat(a.toString().padStart(2,"0"),",").concat((null==n?void 0:n.name)||"Unknown","\n")}):i+="".concat(r,"-").concat((s+1).toString().padStart(2,"0"),"-").concat(a.toString().padStart(2,"0"),",No Assignment\n")}let l=new Blob([i],{type:"text/csv"}),o=window.URL.createObjectURL(l),d=document.createElement("a");d.href=o,d.download="schedule-".concat(H(s,a),"-").concat(r,".csv"),d.click(),window.URL.revokeObjectURL(o)},es=(e,t,s,r,a)=>{let n=document.createElement("canvas"),i=n.getContext("2d");if(!i)return;let l=T(s,r);n.width=840,n.height=60+40*Math.ceil(l/7),i.fillStyle="#ffffff",i.fillRect(0,0,n.width,n.height),i.fillStyle="#000000",i.font="bold 24px Arial",i.textAlign="center",i.fillText("".concat(H(s,a)," ").concat(r," Schedule"),n.width/2,30),i.font="14px Arial",i.textAlign="left";for(let s=1;s<=l;s++){let r=Math.floor((s-1)/7),a=(s-1)%7*120,n=60+40*r;i.strokeStyle="#cccccc",i.strokeRect(a,n,120,40),i.fillStyle="#000000",i.fillText(s.toString(),a+5,n+20);let l=e[s]||[];if(l.length>0){let e=t.find(e=>e.id===l[0]);i.fillStyle="#0066cc",i.fillText((null==e?void 0:e.name)||"Unknown",a+5,n+35)}}n.toBlob(e=>{if(e){let t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="schedule-".concat(H(s,a),"-").concat(r,".png"),n.click(),window.URL.revokeObjectURL(t)}})},er=e=>{var t;let{schedule:s,employees:n,selectedMonth:i,selectedYear:l,hasActiveSchedule:o,constraints:d=[],selectedEmployee:c,onSetConstraint:h,onRemoveConstraint:u,onGenerateSchedule:m,isGenerating:x=!1}=e,[p,y]=(0,a.useState)(!1),b=(0,a.useRef)(null),N=(0,G.c3)();(0,a.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let S=e=>{if(!c||!h||!u)return;let t=d.find(t=>t.employeeId===c&&t.date===e);t?"prefer"===t.type?h(c,"avoid",e):"avoid"===t.type&&u(c,e):h(c,"prefer",e)};return(0,r.jsxs)(g,{children:[(0,r.jsxs)(f,{children:[(0,r.jsxs)(v,{className:"flex items-center justify-between",children:[N("schedule.title"),(0,r.jsxs)("div",{className:"flex gap-2",children:[m&&(0,r.jsx)(w,{onClick:m,disabled:0===n.length||x,size:"sm",children:x?N("schedule.generating"):N("schedule.generateButton")}),Object.keys(s).length>0&&(0,r.jsxs)("div",{className:"relative",ref:b,children:[(0,r.jsxs)(w,{variant:"outline",size:"sm",onClick:()=>y(!p),className:"flex items-center gap-2",children:[N("schedule.export"),(0,r.jsx)(k.A,{className:"w-4 h-4"})]}),p&&(0,r.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:[(0,r.jsxs)("button",{onClick:()=>{if(0===Object.keys(s).length)return void B.oR.error(N("toast.noSchedule"),{description:N("toast.pleaseGenerateFirst")});try{et(s,n,i,l,N),B.oR.success(N("toast.csvExported"),{description:N("toast.csvExportedDescription")})}catch(e){B.oR.error(N("toast.exportFailed"),{description:N("toast.csvExportFailedDescription")})}y(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(K.A,{className:"w-4 h-4"}),N("schedule.exportCSV")]}),(0,r.jsxs)("button",{onClick:()=>{if(0===Object.keys(s).length)return void B.oR.error(N("toast.noSchedule"),{description:N("toast.pleaseGenerateFirst")});try{es(s,n,i,l,N),B.oR.success(N("toast.imageExported"),{description:N("toast.imageExportedDescription")})}catch(e){B.oR.error(N("toast.exportFailed"),{description:N("toast.imageExportFailedDescription")})}y(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(ee.A,{className:"w-4 h-4"}),N("schedule.exportImage")]})]})]})]})]}),c&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[N("schedule.settingPreferencesFor")," ",(0,r.jsx)("strong",{children:null==(t=n.find(e=>e.id===c))?void 0:t.name})]})]}),(0,r.jsxs)(j,{children:[!o&&(0,r.jsx)("p",{className:"text-muted-foreground",children:N("schedule.noActiveSchedule")}),o&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium mb-4",children:N("schedule.monthSchedule",{month:H(i,N),year:l})}),(0,r.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[[N("days.0"),N("days.1"),N("days.2"),N("days.3"),N("days.4"),N("days.5"),N("days.6")].map(e=>(0,r.jsx)("div",{className:"p-2 text-center font-medium bg-muted rounded",children:e},e)),(()=>{if(!i||!l)return null;let e=O(i,l),t=T(i,l),a=[];for(let t=0;t<e;t++)a.push((0,r.jsx)("div",{className:"p-2 h-16"},"empty-".concat(t)));for(let e=1;e<=t;e++){let t=s[e]||[],i=c?d.find(t=>t.employeeId===c&&t.date===e):null,l=c&&t.includes(c),o="p-2 h-16 border rounded-lg ";c&&(o+="cursor-pointer transition-colors ",l?(null==i?void 0:i.type)==="prefer"?o+="bg-green-200 border-green-400 hover:bg-green-300 ring-2 ring-blue-400":(null==i?void 0:i.type)==="avoid"?o+="bg-red-200 border-red-400 hover:bg-red-300 ring-2 ring-blue-400":o+="bg-blue-100 border-blue-400 hover:bg-blue-200 ring-2 ring-blue-400":(null==i?void 0:i.type)==="prefer"?o+="bg-green-100 border-green-300 hover:bg-green-200":(null==i?void 0:i.type)==="avoid"?o+="bg-red-100 border-red-300 hover:bg-red-200":o+="hover:border-blue-300 hover:bg-blue-50"),a.push((0,r.jsxs)("div",{className:o,onClick:()=>c&&S(e),children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e}),t.map(e=>{let t=n.find(t=>t.id===e),s=c===e;return(0,r.jsx)("div",{className:"text-xs truncate ".concat(s?"text-blue-800 font-semibold bg-blue-50 rounded border border-blue-200":"text-blue-600"),title:null==t?void 0:t.name,children:null==t?void 0:t.name},e)})]},e))}return a})()]}),c&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-blue-800 mb-2",children:N("schedule.clickToSetPreferences")}),(0,r.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),(0,r.jsx)("span",{children:N("schedule.preferredDays")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-red-100 border border-red-300 rounded"}),(0,r.jsx)("span",{children:N("schedule.avoidDays")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-white border border-gray-300 rounded"}),(0,r.jsx)("span",{children:N("schedule.normalDays")})]})]})]})]})]})]})};var ea=s(143),en=s(4869);let ei={en:{name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8"},"zh-TW":{name:"繁體中文",flag:"\uD83C\uDDF9\uD83C\uDDFC"}};function el(){let{locale:e,setLocale:t}=(0,ea.Y)();return(0,r.jsxs)(E,{value:e,onValueChange:e=>{t(e)},children:[(0,r.jsx)(A,{className:"w-10 h-10 p-0 border-none hover:bg-muted/50 rounded-md",children:(0,r.jsx)(P,{children:(0,r.jsx)(en.A,{className:"h-5 w-5"})})}),(0,r.jsxs)(z,{children:[(0,r.jsx)(R,{value:"en",children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:ei.en.flag}),(0,r.jsx)("span",{children:ei.en.name})]})}),(0,r.jsx)(R,{value:"zh-TW",children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:ei["zh-TW"].flag}),(0,r.jsx)("span",{children:ei["zh-TW"].name})]})})]})]})}var eo=s(1368);let ed={shiftsPerDay:1,personsPerShift:1,maxConsecutiveShifts:3,minRestDaysBetweenShifts:0,weekendCoverageRequired:!0,maxShiftsPerWeek:5,minShiftsPerWeek:1,evenDistribution:!0},ec=()=>{let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(ed),[l,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{d(),o(!0)},[]),(0,a.useEffect)(()=>{!1!==l&&localStorage.setItem("scheduleData",JSON.stringify({schedules:e,settings:n}))},[e,n,l]);let d=()=>{let e=localStorage.getItem("scheduleData");if(e)try{let s=JSON.parse(e);t((s.schedules||[]).map(e=>({...e,createdAt:new Date(e.createdAt)}))),i({...ed,...s.settings})}catch(e){console.error("Error loading from localStorage:",e)}},c=(e,s)=>{t(t=>t.map(t=>t.id===e?{...t,...s}:t))},h=()=>e.find(e=>e.id===s)||null,u=h(),m=(null==u?void 0:u.month)||0,x=(null==u?void 0:u.year)||0,p=(null==u?void 0:u.employees)||[],g=(null==u?void 0:u.constraints)||[];return{schedules:e,activeScheduleId:s,setActiveScheduleId:r,addSchedule:(s,a,n)=>{if(e.some(e=>e.month===s&&e.year===a))throw Error("Schedule for ".concat(s,"/").concat(a," already exists"));let i=[];if(n){let t=e.find(e=>e.id===n);t&&t.employees.length>0&&(i=t.employees.map(e=>({...e,id:(0,eo.A)()})))}let l={id:(0,eo.A)(),month:s,year:a,employees:i,constraints:[],schedule:{},createdAt:new Date,isGenerated:!1};return t(e=>[...e,l]),r(l.id),l.id},deleteSchedule:e=>{t(t=>t.filter(t=>t.id!==e)),s===e&&r(null)},updateSchedule:c,getActiveSchedule:h,selectedMonth:m,selectedYear:x,employees:p,setEmployees:e=>{s&&c(s,{employees:e})},constraints:g,setConstraints:e=>{s&&c(s,{constraints:e})},schedule:(null==u?void 0:u.schedule)||{},setSchedule:e=>{s&&c(s,{schedule:e,isGenerated:Object.keys(e).length>0})},settings:n,setSettings:i}},eh=(e,t,s,r,a,n,i)=>({addEmployee:()=>{let s=i?i("employees.newEmployee"):"New Employee",r=(e.length+1).toString().padStart(3,"0"),a={id:(0,eo.A)(),name:"".concat(s," ").concat(r),shiftsPerMonth:8,tags:[]};t([...e,a]),i?B.oR.success(i("toast.employeeAdded"),{description:i("toast.employeeAddedDescription",{name:a.name})}):B.oR.success("Employee added",{description:"".concat(a.name," has been added to the schedule.")})},removeEmployee:i=>{t(e.filter(e=>e.id!==i)),r(s.filter(e=>e.employeeId!==i));let l={...a};Object.keys(l).forEach(e=>{l[Number.parseInt(e)]=l[Number.parseInt(e)].filter(e=>e!==i)}),n(l)},updateEmployee:(s,r)=>{t(e.map(e=>e.id===s?{...e,...r}:e)),i?B.oR.success(i("toast.employeeUpdated"),{description:i("toast.employeeUpdatedDescription")}):B.oR.success("Employee updated",{description:"Employee information has been saved."})},toggleEmployeeTag:(s,r)=>{t(e.map(e=>{if(e.id===s){let t=e.tags.includes(r);return{...e,tags:t?e.tags.filter(e=>e!==r):[...e.tags,r]}}return e}))}}),eu=(e,t)=>({getConstraintsForEmployee:t=>e.filter(e=>e.employeeId===t),getConstraintForDate:(t,s)=>e.find(e=>e.employeeId===t&&e.date===s),removeConstraint:(s,r)=>{t(e.filter(e=>e.employeeId!==s||e.date!==r))},setConstraint:(s,r,a)=>{t([...e.filter(e=>e.employeeId!==s||e.date!==a),{id:(0,eo.A)(),employeeId:s,type:r,date:a}])}});var em=s(2764),ex=s.n(em);let ep=e=>Math.floor(Math.random()*e),eg=(e,t,s,r)=>{let{shiftsPerDay:a,personsPerShift:n}=s;if(e.length<r*a*n)throw Error("Not enough slots in optimized schedule");let i={},l=0;for(let s=1;s<=r;s++){i[s]=[];for(let r=0;r<a;r++)for(let r=0;r<n;r++){let r=e[l];if(r>=0&&r<t.length)i[s].push(t[r].id),l++;else throw Error("Invalid employee index ".concat(r," in optimized schedule"))}}return i},ef=e=>{let t=[];e.forEach((e,s)=>{for(let r=0;r<e.shiftsPerMonth;r++)t.push(s)});for(let e=t.length-1;e>0;e--){let s=ep(e+1);[t[e],t[s]]=[t[s],t[e]]}return t},ev=(e,t,s,r,a,n,i)=>{let l=0,{shiftsPerDay:o,personsPerShift:d}=r,c=a*o*d,h=Array(t.length).fill(0),u=t.map(()=>({current:0,max:0})),m=Array(t.length).fill(0),x=Array(t.length).fill(0),p=t.map(()=>({current:0,max:0})),g=e.slice(0,c);if(g.length<c)throw Error("Optimized schedule does not have enough slots: expected ".concat(c,", got ").concat(g.length));g.forEach(e=>{if(e<-1||e>=t.length)throw Error("Invalid employee index ".concat(e," in optimized schedule"))});for(let e=0;e<a;e++){let r=e+1,a=e*o*d,c=a+o*d,f=g.slice(a,c);for(let e=0;e<o;e++){let t=a+e*d,s=t+d;new Set(g.slice(t,s)).size<d&&(l+=2e3)}let v=U(r,n,i);s.forEach(e=>{if("avoid"===e.type&&e.date===r){let s=t.findIndex(t=>t.id===e.employeeId);-1!==s&&f.includes(s)&&(l+=1e3)}if("prefer"===e.type&&e.date===r){let s=t.findIndex(t=>t.id===e.employeeId);-1===s||f.includes(s)||(l+=10)}});let j=[...new Set(f)];j.forEach(s=>{var r;if(h[s]++,v?m[s]++:x[s]++,e>0){let t=(e-1)*o*d,r=e*o*d,a=!1;for(let e=t;e<r;e++)if(g[e]===s){a=!0;break}a?u[s].current++:u[s].current=1}else u[s].current=1;if(u[s].max=Math.max(u[s].max,u[s].current),v&&(null==(r=t[s])?void 0:r.tags.includes("tags.weekendType"))){if(e>0){let t=U(e,n,i),r=(e-1)*o*d,a=e*o*d,l=!1;if(t){for(let e=r;e<Math.min(a,g.length);e++)if(g[e]===s){l=!0;break}}l?p[s].current++:p[s].current=1}else p[s].current=1;p[s].max=Math.max(p[s].max,p[s].current)}else p[s].current=0}),t.forEach((e,t)=>{j.includes(t)||(u[t].current=0,p[t].current=0)})}t.forEach((e,t)=>{let s=0;u[t].max>r.maxConsecutiveShifts&&(s+=(u[t].max-r.maxConsecutiveShifts)*100),e.tags.includes("tags.weekendType")&&(p[t].max>=2?s=0:s+=50),l+=s});for(let e=0;e<Math.ceil(a/7);e++){let s=7*e,n=Math.min(s+6,a-1);t.forEach((e,t)=>{let a=0,i=[];for(let e=s;e<=n;e++){let s=e*o*d,r=Math.min((e+1)*o*d,g.length),n=!1;for(let e=s;e<r;e++)if(g[e]===t){n=!0;break}n&&(a++,i.push(e))}a>r.maxShiftsPerWeek&&(l+=(a-r.maxShiftsPerWeek)*100);for(let e=0;e<i.length-1;e++){let t=i[e+1]-i[e]-1;t<r.minRestDaysBetweenShifts&&(l+=(r.minRestDaysBetweenShifts-t)*80)}})}if(r.evenDistribution){let e=h.reduce((e,t)=>e+t,0)/h.length,t=h.reduce((t,s)=>t+Math.pow(s-e,2),0)/h.length;l+=50*t}let f=m.reduce((e,t)=>e+t,0),v=x.reduce((e,t)=>e+t,0);return f>0&&v>0&&t.forEach((e,t)=>{let s=h[t];if(s>0){let e=Math.abs(m[t]/s-f/(f+v));m[t]>0&&0===x[t]&&s>1?l+=2e3:x[t]>0&&0===m[t]&&s>1?l+=1e3:e>.3&&(l+=1e3*e)}}),console.log("Cost calculated: ".concat(l)),l},ej=e=>{let t=[...e];if(t.length<2)return t;let s=["swap","move","reverse","transport"],r=s[ep(s.length)],a=ep(t.length),n=ep(t.length);switch(r){case"swap":[t[a],t[n]]=[t[n],t[a]];break;case"move":{let e=t.splice(a,1)[0];t.splice(n,0,e);break}case"reverse":{let e=Math.min(a,n),s=Math.max(a,n);for(;e<s;)[t[e],t[s]]=[t[s],t[e]],e++,s--;break}case"transport":{if(t.length<3)break;let e=Math.min(a,n),s=Math.max(a,n);if(e<s){let r=t.splice(e,s-e+1),a=ep(t.length);t.splice(a,0,...r)}}}return t},ey=(e,t,s,r,a)=>{if(0===e.length)return{schedule:{},success:!1,message:"Please add employees before generating a schedule."};let n=T(r,a),i=n*s.shiftsPerDay*s.personsPerShift,l=e.reduce((e,t)=>e+t.shiftsPerMonth,0);if(l<i)return{schedule:{},success:!1,message:"Need ".concat(i," total shifts, but only ").concat(l," available.")};let o=ef(e);try{console.log("Starting optimized simulated annealing with ".concat(e.length," employees, ").concat(n," days"));let i=Date.now(),l=ex()({initialState:o,tempMax:1e3,tempMin:.1,newState:e=>ej(e),getTemp:e=>.99*e,getEnergy:i=>ev(i,e,t,s,n,r,a)}),d=Date.now();console.log("Simulated annealing completed in ".concat(d-i,"ms"));let c=eg(l,e,s,n),h=ev(l,e,t,s,n,r,a),u=0===h?"Perfect schedule generated with all constraints satisfied!":"Schedule generated with optimization score: ".concat(Math.round(Math.max(0,h)));return{schedule:c,success:!0,message:u}}catch(e){return console.error("Simulated annealing failed:",e),{schedule:{},success:!1,message:"Simulated annealing failed."}}},eb=()=>{let[e,t]=(0,a.useState)(!1);return{isGenerating:e,handleGenerateSchedule:async(e,s,r,a,n,i)=>{t(!0);try{await new Promise(e=>setTimeout(e,500));let t=ey(e,s,r,a,n);t.success?(i(t.schedule),B.oR.success("Schedule generated",{description:t.message})):B.oR.error("Generation failed",{description:t.message})}catch(e){B.oR.error("Generation error",{description:"An unexpected error occurred while generating the schedule."})}finally{t(!1)}}}};function eN(){let e=(0,G.c3)(),{schedules:t,activeScheduleId:s,setActiveScheduleId:n,addSchedule:i,deleteSchedule:l,selectedMonth:o,selectedYear:g,employees:f,setEmployees:v,constraints:j,setConstraints:y,schedule:b,setSchedule:N,settings:w,setSettings:S}=ec(),{addEmployee:k,removeEmployee:D,updateEmployee:C,toggleEmployeeTag:E}=eh(f,v,j,y,b,N,e),{setConstraint:P,removeConstraint:A}=eu(j,y),{isGenerating:z,handleGenerateSchedule:R}=eb(),[M,I]=(0,a.useState)("");return(0,r.jsx)("div",{children:(0,r.jsxs)(d,{defaultValue:"about",className:"space-y-0",children:[(0,r.jsx)(c,{className:"w-full",children:(0,r.jsxs)("div",{className:"container flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)(h,{value:"about",className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),"About"]}),(0,r.jsxs)(h,{value:"setup",className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"w-4 h-4"}),e("page.setup")]}),(0,r.jsxs)(h,{value:"constraints",className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),e("page.constraints")]})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(el,{})})]})}),(0,r.jsx)(u,{value:"about",className:"mt-0",children:(0,r.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"text-center max-w-3xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-4",children:e("page.title")}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground leading-relaxed",children:e("page.description")})]})})})}),(0,r.jsx)(u,{value:"setup",className:"mt-0",children:(0,r.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(Y,{schedules:t,activeScheduleId:s,onScheduleSelect:n,onScheduleAdd:i,onScheduleDelete:l}),(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,r.jsx)(Z,{employees:f,selectedEmployee:M,onEmployeeSelect:I,onAddEmployee:k,onRemoveEmployee:D,onUpdateEmployee:C,onToggleTag:E,predefinedTags:["tags.weekendType","tags.burger","tags.morningShift","tags.eveningShift","tags.manager","tags.partTime"],hasActiveSchedule:null!==s}),(0,r.jsx)("div",{className:"xl:col-span-2",children:(0,r.jsx)(er,{schedule:b,employees:f,selectedMonth:o,selectedYear:g,hasActiveSchedule:null!==s,constraints:j,selectedEmployee:M,onSetConstraint:P,onRemoveConstraint:A,onGenerateSchedule:()=>{R(f,j,w,o,g,N)},isGenerating:z})})]})]})})}),(0,r.jsx)(u,{value:"constraints",className:"mt-0",children:(0,r.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)($,{settings:w,onSettingsChange:S})})})})]})})}},143:(e,t,s)=>{"use strict";s.d(t,{LocaleProvider:()=>l,Y:()=>o});var r=s(5155),a=s(2115),n=s(6096);let i=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[l,o]=(0,a.useState)("en"),[d,c]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let e=localStorage.getItem("locale");e&&("en"===e||"zh-TW"===e)&&o(e)},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=await s(5272)("./".concat(l,".json"));c(e.default)}catch(e){console.error("Failed to load messages:",e)}})()},[l]),d)?(0,r.jsx)(i.Provider,{value:{locale:l,setLocale:e=>{o(e),localStorage.setItem("locale",e)}},children:(0,r.jsx)(n.A,{locale:l,messages:d,children:t})}):(0,r.jsx)("div",{children:"Loading..."})}function o(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useLocale must be used within a LocaleProvider");return e}},5272:(e,t,s)=>{var r={"./en.json":[9373,373],"./zh-TW.json":[9032,32]};function a(e){if(!s.o(r,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],a=t[0];return s.e(t[1]).then(()=>s.t(a,19))}a.keys=()=>Object.keys(r),a.id=5272,e.exports=a},9848:(e,t,s)=>{Promise.resolve().then(s.bind(s,18))}},e=>{var t=t=>e(e.s=t);e.O(0,[208,865,441,684,358],()=>t(9848)),_N_E=e.O()}]);