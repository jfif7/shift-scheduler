(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8349:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eg});var r=s(5155),a=s(2115),n=s(2473),i=s(2596),l=s(9688);function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.QP)((0,i.$)(t))}function d(e){let{className:t,...s}=e;return(0,r.jsx)(n.bL,{"data-slot":"tabs",className:o("flex flex-col gap-2",t),...s})}function c(e){let{className:t,...s}=e;return(0,r.jsx)(n.B8,{"data-slot":"tabs-list",className:o("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...s})}function u(e){let{className:t,...s}=e;return(0,r.jsx)(n.l9,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function h(e){let{className:t,...s}=e;return(0,r.jsx)(n.UC,{"data-slot":"tabs-content",className:o("flex-1 outline-none",t),...s})}var m=s(9074),x=s(381);function p(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function g(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function f(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",t),...s})}function v(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:o("px-6",t),...s})}var y=s(9708),b=s(2085);let j=(0,b.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function N(e){let{className:t,variant:s,size:a,asChild:n=!1,...i}=e,l=n?y.DX:"button";return(0,r.jsx)(l,{"data-slot":"button",className:o(j({variant:s,size:a,className:t})),...i})}var w=s(721),S=s(6474),k=s(5196),D=s(7863);function C(e){let{...t}=e;return(0,r.jsx)(w.bL,{"data-slot":"select",...t})}function E(e){let{...t}=e;return(0,r.jsx)(w.WT,{"data-slot":"select-value",...t})}function P(e){let{className:t,size:s="default",children:a,...n}=e;return(0,r.jsxs)(w.l9,{"data-slot":"select-trigger","data-size":s,className:o("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[a,(0,r.jsx)(w.In,{asChild:!0,children:(0,r.jsx)(S.A,{className:"size-4 opacity-50"})})]})}function R(e){let{className:t,children:s,position:a="popper",...n}=e;return(0,r.jsx)(w.ZL,{children:(0,r.jsxs)(w.UC,{"data-slot":"select-content",className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[(0,r.jsx)(z,{}),(0,r.jsx)(w.LM,{className:o("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,r.jsx)(M,{})]})})}function A(e){let{className:t,children:s,...a}=e;return(0,r.jsxs)(w.q7,{"data-slot":"select-item",className:o("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...a,children:[(0,r.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(w.VF,{children:(0,r.jsx)(k.A,{className:"size-4"})})}),(0,r.jsx)(w.p4,{children:s})]})}function z(e){let{className:t,...s}=e;return(0,r.jsx)(w.PP,{"data-slot":"select-scroll-up-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(D.A,{className:"size-4"})})}function M(e){let{className:t,...s}=e;return(0,r.jsx)(w.wn,{"data-slot":"select-scroll-down-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(S.A,{className:"size-4"})})}var I=s(4616),F=s(646),_=s(9428),H=s(2525);let W=(e,t)=>e<0||e>11||!t?0:new Date(t,e+1,0).getDate(),L=(e,t)=>e<0||e>11?"":t("months.".concat(e))||"",O=(e,t)=>new Date(t,e,1).getDay(),T=(e,t,s)=>{let r=new Date(s,t,e).getDay();return 0===r||6===r};var U=s(6671),B=s(7652);let G=e=>{let{schedules:t,activeScheduleId:s,onScheduleSelect:n,onScheduleAdd:i,onScheduleDelete:l}=e,[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[y,b]=(0,a.useState)("auto"),j=(0,B.c3)(),w=s&&!o,S=new Date,k=S.getMonth(),D=S.getFullYear(),z=()=>{if(0===t.length)return null;let e=t[0];for(let s=1;s<t.length;s++){let r=t[s];(r.year>e.year||r.year===e.year&&r.month>e.month)&&(e=r)}return e},M=()=>{let e=z();if(!e)return{month:k,year:D};let t=new Date(e.year,e.month),s=new Date(t.getFullYear(),t.getMonth()+1);return{month:s.getMonth(),year:s.getFullYear()}},W=(e,t,s)=>{l(e),U.oR.success(j("toast.scheduleDeleted"),{description:j("toast.scheduleDeletedDescription",{month:L(t,j),year:s})})},O=[...t].sort((e,t)=>t.year-e.year||t.month-e.month),T=Array.from({length:12},(e,t)=>({value:t.toString(),label:j("months.".concat(t))})),G=Array.from({length:10},(e,t)=>{let s=S.getFullYear()-2+t;return{value:s.toString(),label:s.toString()}});return(0,r.jsxs)(p,{children:[(0,r.jsxs)(g,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(f,{className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"w-5 h-5"}),j("scheduleHistory.title"),w&&s&&(0,r.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["-"," ",(()=>{let e=t.find(e=>e.id===s);return e?"".concat(L(e.month,j)," ").concat(e.year):""})()]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[w&&(0,r.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>n(null),className:"flex items-center gap-2",children:j("scheduleHistory.showAll")}),(0,r.jsxs)(N,{onClick:()=>{let{month:e,year:t}=M();d(!0),u(e),x(t),b("auto")},size:"sm",className:"flex items-center gap-2",children:[(0,r.jsx)(I.A,{className:"w-4 h-4"}),j("scheduleHistory.addSchedule")]})]})]}),0===t.length&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:j("scheduleHistory.noSchedulesYet")})]}),!w&&(0,r.jsxs)(v,{className:"space-y-4",children:[o&&(0,r.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50 space-y-4",children:[(0,r.jsx)("h4",{className:"font-medium",children:j("scheduleHistory.createNewSchedule")}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:j("scheduleHistory.month")}),(0,r.jsxs)(C,{value:(null==c?void 0:c.toString())||"",onValueChange:e=>u(parseInt(e)),children:[(0,r.jsx)(P,{children:(0,r.jsx)(E,{placeholder:j("scheduleHistory.selectMonth")})}),(0,r.jsx)(R,{children:T.map(e=>(0,r.jsx)(A,{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:j("scheduleHistory.year")}),(0,r.jsxs)(C,{value:(null==h?void 0:h.toString())||"",onValueChange:e=>x(parseInt(e)),children:[(0,r.jsx)(P,{children:(0,r.jsx)(E,{placeholder:j("scheduleHistory.selectYear")})}),(0,r.jsx)(R,{children:G.map(e=>(0,r.jsx)(A,{value:e.value,children:e.label},e.value))})]})]})]}),t.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:j("scheduleHistory.employeeImport")}),(0,r.jsxs)(C,{value:y,onValueChange:b,children:[(0,r.jsx)(P,{children:(0,r.jsx)(E,{placeholder:j("scheduleHistory.chooseImportOption")})}),(0,r.jsxs)(R,{children:[(0,r.jsx)(A,{value:"auto",children:j("scheduleHistory.autoImportFromRecent")}),(0,r.jsx)(A,{value:"none",children:j("scheduleHistory.startWithEmptyList")}),O.map(e=>(0,r.jsxs)(A,{value:e.id,children:[j("scheduleHistory.copyFrom")," ",L(e.month,j)," ",e.year," (",e.employees.length," ",j("scheduleHistory.employees"),")"]},e.id))]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:j("scheduleHistory.importNote")})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(N,{onClick:()=>{if(!c||!h)return void U.oR.error(j("toast.invalidInput"),{description:j("toast.selectBothMonthYear")});try{let e;if("auto"===y){let t=z();e=null==t?void 0:t.id}else"none"!==y&&(e=y);i(c,h,e),d(!1),u(null),x(null),b("auto");let t=e?j("toast.withImportedEmployees"):j("toast.withEmptyEmployeeList");U.oR.success(j("toast.scheduleCreated"),{description:j("toast.scheduleCreatedDescription",{month:L(c,j),year:h,importMessage:t})})}catch(e){U.oR.error(j("toast.creationFailed"),{description:e instanceof Error?e.message:j("toast.creationFailedDescription")})}},size:"sm",children:j("scheduleHistory.createSchedule")}),(0,r.jsx)(N,{variant:"outline",onClick:()=>{d(!1),u(null),x(null),b("auto")},size:"sm",children:j("scheduleHistory.cancel")})]})]}),O.length>0&&(0,r.jsx)("div",{className:"space-y-2",children:O.map(e=>(0,r.jsxs)("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors ".concat(e.id===s?"bg-primary/10 border-primary":"hover:bg-muted/50"),onClick:()=>{e.id===s?n(null):n(e.id)},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.isGenerated?(0,r.jsx)(F.A,{className:"w-4 h-4 text-green-600"}):(0,r.jsx)(_.A,{className:"w-4 h-4 text-muted-foreground"}),(0,r.jsxs)("span",{className:"font-medium",children:[L(e.month,j)," ",e.year]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.employees.length," ",j("scheduleHistory.employees")]}),(0,r.jsx)(N,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),W(e.id,e.month,e.year)},className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-destructive/10",children:(0,r.jsx)(H.A,{className:"w-3 h-3"})})]})]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[j("scheduleHistory.created")," ",e.createdAt.toLocaleDateString(),e.isGenerated&&(0,r.jsxs)("span",{className:"ml-2 text-green-600",children:["â€¢ ",j("scheduleHistory.generated")]})]})]},e.id))})]})]})};function q(e){let{className:t,type:s,...a}=e;return(0,r.jsx)("input",{type:s,"data-slot":"input",className:o("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a})}var V=s(968);function Y(e){let{className:t,...s}=e;return(0,r.jsx)(V.b,{"data-slot":"label",className:o("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}let J=(0,b.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function X(e){let{className:t,variant:s,asChild:a=!1,...n}=e,i=a?y.DX:"span";return(0,r.jsx)(i,{"data-slot":"badge",className:o(J({variant:s}),t),...n})}let Q=e=>{let{employees:t,selectedEmployee:s,onEmployeeSelect:n,onAddEmployee:i,onRemoveEmployee:l,onUpdateEmployee:o,onToggleTag:d,predefinedTags:c,hasActiveSchedule:u}=e,[h,m]=(0,a.useState)(""),[x,y]=(0,a.useState)(""),[b,j]=(0,a.useState)(0),w=(0,B.c3)(),S=e=>{m(e.id),y(e.name),j(e.shiftsPerMonth)},k=()=>{o(h,{name:x,shiftsPerMonth:b}),m("")},D=()=>{m(""),y(""),j(0)};return(0,r.jsxs)(p,{className:"flex flex-col h-[600px]",children:[(0,r.jsxs)(g,{className:"flex-shrink-0",children:[(0,r.jsx)(f,{children:w("employees.title")}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:u?w("employees.selectScheduleDescription"):w("employees.noActiveScheduleDescription")})]}),(0,r.jsx)(v,{className:"flex-1 flex flex-col overflow-hidden",children:u?0===t.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:w("employees.noEmployeesMessage")}),(0,r.jsxs)(N,{onClick:i,children:[(0,r.jsx)(I.A,{className:"w-4 h-4 mr-2"}),w("employees.addFirstEmployee")]})]}):(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,r.jsx)("div",{className:"flex-1 space-y-3 overflow-y-auto pr-2",children:t.map(e=>(0,r.jsx)("div",{className:"border rounded-lg transition-colors ".concat(s===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:h===e.id?(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(Y,{htmlFor:"editName",children:w("employees.name")}),(0,r.jsx)(q,{id:"editName",value:x,onChange:e=>y(e.target.value),placeholder:w("employees.namePlaceholder")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(Y,{htmlFor:"editShifts",children:w("employees.shiftsPerMonth")}),(0,r.jsx)(q,{id:"editShifts",type:"number",min:"1",max:"31",value:b,onChange:e=>j(Number.parseInt(e.target.value)||0)})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(Y,{children:w("employees.tags")}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map(t=>{let s=e.tags.includes(t);return(0,r.jsx)(N,{variant:s?"default":"outline",size:"sm",onClick:()=>d(e.id,t),children:w(t)},t)})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(N,{onClick:k,size:"sm",children:w("employees.save")}),(0,r.jsx)(N,{onClick:D,variant:"outline",size:"sm",children:w("employees.cancel")}),(0,r.jsxs)(N,{onClick:()=>{l(e.id),m("")},variant:"destructive",size:"sm",children:[(0,r.jsx)(H.A,{className:"w-4 h-4 mr-1"}),w("employees.delete")]})]})]}):(0,r.jsx)("div",{className:"p-3 cursor-pointer",onClick:()=>n(s===e.id?"":e.id),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsxs)(X,{variant:"secondary",children:[e.shiftsPerMonth," ",w("employees.shifts")]})]}),e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.tags.map(e=>(0,r.jsx)(X,{variant:"outline",className:"text-xs",children:w(e)},w(e)))}),s===e.id&&(0,r.jsx)("div",{className:"mt-2 text-xs text-blue-600",children:w("employees.selectedDescription")})]}),(0,r.jsx)(N,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),S(e)},children:w("employees.edit")})]})})},e.id))}),u&&(0,r.jsxs)(N,{onClick:i,variant:"outline",className:"w-full mt-3 flex-shrink-0",children:[(0,r.jsx)(I.A,{className:"w-4 h-4 mr-2"}),w("employees.addEmployee")]})]}):(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:w("employees.noActiveScheduleMessage")})})})]})},Z=e=>{let{settings:t,onSettingsChange:s}=e,a=(0,B.c3)(),n=(e,r)=>{s({...t,[e]:r})};return(0,r.jsxs)(p,{children:[(0,r.jsxs)(g,{children:[(0,r.jsx)(f,{children:a("constraints.title")}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:a("constraints.description")})]}),(0,r.jsxs)(v,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Y,{htmlFor:"shiftsPerDay",children:a("constraints.shiftsPerDay")}),(0,r.jsx)(q,{id:"shiftsPerDay",type:"number",min:"1",max:"3",value:t.shiftsPerDay,onChange:e=>n("shiftsPerDay",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.shiftsPerDayDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Y,{htmlFor:"personsPerShift",children:a("constraints.personsPerShift")}),(0,r.jsx)(q,{id:"personsPerShift",type:"number",min:"1",max:"10",value:t.personsPerShift,onChange:e=>n("personsPerShift",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.personsPerShiftDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Y,{htmlFor:"maxConsecutive",children:a("constraints.maxConsecutiveShifts")}),(0,r.jsx)(q,{id:"maxConsecutive",type:"number",min:"1",max:"7",value:t.maxConsecutiveShifts,onChange:e=>n("maxConsecutiveShifts",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.maxConsecutiveShiftsDescription")})]})]}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:a("constraints.restAndRecovery")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Y,{htmlFor:"minRestDays",children:a("constraints.minRestDaysBetweenShifts")}),(0,r.jsx)(q,{id:"minRestDays",type:"number",min:"0",max:"3",value:t.minRestDaysBetweenShifts,onChange:e=>n("minRestDaysBetweenShifts",Number.parseInt(e.target.value)||0)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.minRestDaysBetweenShiftsDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(Y,{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.weekendCoverageRequired,onChange:e=>n("weekendCoverageRequired",e.target.checked),className:"rounded"}),a("constraints.weekendCoverageRequired")]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.weekendCoverageRequiredDescription")})]})]})]}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:a("constraints.weeklyLimits")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Y,{htmlFor:"minShiftsPerWeek",children:a("constraints.minShiftsPerWeek")}),(0,r.jsx)(q,{id:"minShiftsPerWeek",type:"number",min:"0",max:"7",value:t.minShiftsPerWeek,onChange:e=>n("minShiftsPerWeek",Number.parseInt(e.target.value)||0)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.minShiftsPerWeekDescription")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Y,{htmlFor:"maxShiftsPerWeek",children:a("constraints.maxShiftsPerWeek")}),(0,r.jsx)(q,{id:"maxShiftsPerWeek",type:"number",min:"1",max:"7",value:t.maxShiftsPerWeek,onChange:e=>n("maxShiftsPerWeek",Number.parseInt(e.target.value)||1)}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.maxShiftsPerWeekDescription")})]})]})]}),(0,r.jsxs)("div",{className:"border-t pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:a("constraints.fairnessAndDistribution")}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(Y,{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.evenDistribution,onChange:e=>n("evenDistribution",e.target.checked),className:"rounded"}),a("constraints.evenShiftDistribution")]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a("constraints.evenShiftDistributionDescription")})]})})]}),(0,r.jsxs)("div",{className:"border-t pt-6 bg-muted/50 p-4 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:a("constraints.constraintSummary")}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.daily"),":"]})," ",t.shiftsPerDay," ",a("constraints.shifts"),","," ",t.personsPerShift," ",a("constraints.persons")," ",a("constraints.each")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.consecutive"),":"]})," ",a("constraints.max")," ",t.maxConsecutiveShifts," ",a("constraints.inARow")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.rest"),":"]})," ",t.minRestDaysBetweenShifts," ",a("constraints.dayMinimum")]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.weekly"),":"]})," ",t.minShiftsPerWeek,"-",t.maxShiftsPerWeek," ",a("constraints.shiftsPerPerson")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.weekend"),":"]})," ",a(t.weekendCoverageRequired?"constraints.required":"constraints.optional")]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[a("constraints.distribution"),":"]})," ",a(t.evenDistribution?"constraints.even":"constraints.flexible")]})]})]})]})]})]})};var $=s(4261),K=s(2118);let ee=(e,t,s,r,a)=>{let n=W(s,r),i="Date,Employee\n";for(let a=1;a<=n;a++){let n=e[a]||[];n.length>0?n.forEach(e=>{let n=t.find(t=>t.id===e);i+="".concat(r,"-").concat((s+1).toString().padStart(2,"0"),"-").concat(a.toString().padStart(2,"0"),",").concat((null==n?void 0:n.name)||"Unknown","\n")}):i+="".concat(r,"-").concat((s+1).toString().padStart(2,"0"),"-").concat(a.toString().padStart(2,"0"),",No Assignment\n")}let l=new Blob([i],{type:"text/csv"}),o=window.URL.createObjectURL(l),d=document.createElement("a");d.href=o,d.download="schedule-".concat(L(s,a),"-").concat(r,".csv"),d.click(),window.URL.revokeObjectURL(o)},et=(e,t,s,r,a)=>{let n=document.createElement("canvas"),i=n.getContext("2d");if(!i)return;let l=W(s,r);n.width=840,n.height=60+40*Math.ceil(l/7),i.fillStyle="#ffffff",i.fillRect(0,0,n.width,n.height),i.fillStyle="#000000",i.font="bold 24px Arial",i.textAlign="center",i.fillText("".concat(L(s,a)," ").concat(r," Schedule"),n.width/2,30),i.font="14px Arial",i.textAlign="left";for(let s=1;s<=l;s++){let r=Math.floor((s-1)/7),a=(s-1)%7*120,n=60+40*r;i.strokeStyle="#cccccc",i.strokeRect(a,n,120,40),i.fillStyle="#000000",i.fillText(s.toString(),a+5,n+20);let l=e[s]||[];if(l.length>0){let e=t.find(e=>e.id===l[0]);i.fillStyle="#0066cc",i.fillText((null==e?void 0:e.name)||"Unknown",a+5,n+35)}}n.toBlob(e=>{if(e){let t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="schedule-".concat(L(s,a),"-").concat(r,".png"),n.click(),window.URL.revokeObjectURL(t)}})},es=e=>{var t;let{schedule:s,employees:n,selectedMonth:i,selectedYear:l,hasActiveSchedule:o,constraints:d=[],selectedEmployee:c,onSetConstraint:u,onRemoveConstraint:h,onGenerateSchedule:m,isGenerating:x=!1}=e,[y,b]=(0,a.useState)(!1),j=(0,a.useRef)(null),w=(0,B.c3)();(0,a.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let k=e=>{if(!c||!u||!h)return;let t=d.find(t=>t.employeeId===c&&t.date===e);t?"prefer"===t.type?u(c,"avoid",e):"avoid"===t.type&&h(c,e):u(c,"prefer",e)};return(0,r.jsxs)(p,{children:[(0,r.jsxs)(g,{children:[(0,r.jsxs)(f,{className:"flex items-center justify-between",children:[w("schedule.title"),(0,r.jsxs)("div",{className:"flex gap-2",children:[m&&(0,r.jsx)(N,{onClick:m,disabled:0===n.length||x,size:"sm",children:x?w("schedule.generating"):w("schedule.generateButton")}),Object.keys(s).length>0&&(0,r.jsxs)("div",{className:"relative",ref:j,children:[(0,r.jsxs)(N,{variant:"outline",size:"sm",onClick:()=>b(!y),className:"flex items-center gap-2",children:[w("schedule.export"),(0,r.jsx)(S.A,{className:"w-4 h-4"})]}),y&&(0,r.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:[(0,r.jsxs)("button",{onClick:()=>{if(0===Object.keys(s).length)return void U.oR.error(w("toast.noSchedule"),{description:w("toast.pleaseGenerateFirst")});try{ee(s,n,i,l,w),U.oR.success(w("toast.csvExported"),{description:w("toast.csvExportedDescription")})}catch(e){U.oR.error(w("toast.exportFailed"),{description:w("toast.csvExportFailedDescription")})}b(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)($.A,{className:"w-4 h-4"}),w("schedule.exportCSV")]}),(0,r.jsxs)("button",{onClick:()=>{if(0===Object.keys(s).length)return void U.oR.error(w("toast.noSchedule"),{description:w("toast.pleaseGenerateFirst")});try{et(s,n,i,l,w),U.oR.success(w("toast.imageExported"),{description:w("toast.imageExportedDescription")})}catch(e){U.oR.error(w("toast.exportFailed"),{description:w("toast.imageExportFailedDescription")})}b(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(K.A,{className:"w-4 h-4"}),w("schedule.exportImage")]})]})]})]})]}),c&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[w("schedule.settingPreferencesFor")," ",(0,r.jsx)("strong",{children:null==(t=n.find(e=>e.id===c))?void 0:t.name})]})]}),(0,r.jsxs)(v,{children:[!o&&(0,r.jsx)("p",{className:"text-muted-foreground",children:w("schedule.noActiveSchedule")}),o&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium mb-4",children:w("schedule.monthSchedule",{month:L(i,w),year:l})}),(0,r.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[[w("days.0"),w("days.1"),w("days.2"),w("days.3"),w("days.4"),w("days.5"),w("days.6")].map(e=>(0,r.jsx)("div",{className:"p-2 text-center font-medium bg-muted rounded",children:e},e)),(()=>{if(!i||!l)return null;let e=O(i,l),t=W(i,l),a=[];for(let t=0;t<e;t++)a.push((0,r.jsx)("div",{className:"p-2 h-16"},"empty-".concat(t)));for(let e=1;e<=t;e++){let t=s[e]||[],i=c?d.find(t=>t.employeeId===c&&t.date===e):null,l=c&&t.includes(c),o="p-2 h-16 border rounded-lg ";c&&(o+="cursor-pointer transition-colors ",l?(null==i?void 0:i.type)==="prefer"?o+="bg-green-200 border-green-400 hover:bg-green-300 ring-2 ring-blue-400":(null==i?void 0:i.type)==="avoid"?o+="bg-red-200 border-red-400 hover:bg-red-300 ring-2 ring-blue-400":o+="bg-blue-100 border-blue-400 hover:bg-blue-200 ring-2 ring-blue-400":(null==i?void 0:i.type)==="prefer"?o+="bg-green-100 border-green-300 hover:bg-green-200":(null==i?void 0:i.type)==="avoid"?o+="bg-red-100 border-red-300 hover:bg-red-200":o+="hover:border-blue-300 hover:bg-blue-50"),a.push((0,r.jsxs)("div",{className:o,onClick:()=>c&&k(e),children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e}),t.map(e=>{let t=n.find(t=>t.id===e),s=c===e;return(0,r.jsx)("div",{className:"text-xs truncate ".concat(s?"text-blue-800 font-semibold bg-blue-50 rounded border border-blue-200":"text-blue-600"),title:null==t?void 0:t.name,children:null==t?void 0:t.name},e)})]},e))}return a})()]}),c&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-blue-800 mb-2",children:w("schedule.clickToSetPreferences")}),(0,r.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),(0,r.jsx)("span",{children:w("schedule.preferredDays")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-red-100 border border-red-300 rounded"}),(0,r.jsx)("span",{children:w("schedule.avoidDays")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-white border border-gray-300 rounded"}),(0,r.jsx)("span",{children:w("schedule.normalDays")})]})]})]})]})]})]})},er={shiftsPerDay:1,personsPerShift:1,maxConsecutiveShifts:3,minRestDaysBetweenShifts:0,weekendCoverageRequired:!0,maxShiftsPerWeek:5,minShiftsPerWeek:1,evenDistribution:!0},ea=()=>{let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(er);(0,a.useEffect)(()=>{o()},[]);let l=(0,a.useCallback)(()=>{localStorage.setItem("scheduleData",JSON.stringify({schedules:e,activeScheduleId:s,settings:n}))},[e,s,n]);(0,a.useEffect)(()=>{l()},[l]);let o=()=>{let e=localStorage.getItem("scheduleData");if(e)try{let s=JSON.parse(e);t((s.schedules||[]).map(e=>({...e,createdAt:new Date(e.createdAt)}))),r(s.activeScheduleId||null),i({...er,...s.settings})}catch(e){console.error("Error loading from localStorage:",e)}},d=(e,s)=>{t(t=>t.map(t=>t.id===e?{...t,...s}:t))},c=()=>e.find(e=>e.id===s)||null,u=c(),h=(null==u?void 0:u.month)||0,m=(null==u?void 0:u.year)||0,x=(null==u?void 0:u.employees)||[],p=(null==u?void 0:u.constraints)||[];return{schedules:e,activeScheduleId:s,setActiveScheduleId:r,addSchedule:(s,a,n)=>{if(e.some(e=>e.month===s&&e.year===a))throw Error("Schedule for ".concat(s,"/").concat(a," already exists"));let i=[];if(n){let t=e.find(e=>e.id===n);t&&t.employees.length>0&&(i=t.employees.map(e=>({...e,id:"".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11))})))}let l={id:Date.now().toString(),month:s,year:a,employees:i,constraints:[],schedule:{},createdAt:new Date,isGenerated:!1};return t(e=>[...e,l]),r(l.id),l.id},deleteSchedule:e=>{t(t=>t.filter(t=>t.id!==e)),s===e&&r(null)},updateSchedule:d,getActiveSchedule:c,selectedMonth:h,selectedYear:m,employees:x,setEmployees:e=>{s&&d(s,{employees:e})},constraints:p,setConstraints:e=>{s&&d(s,{constraints:e})},schedule:(null==u?void 0:u.schedule)||{},setSchedule:e=>{s&&d(s,{schedule:e,isGenerated:Object.keys(e).length>0})},settings:n,setSettings:i}},en=(e,t,s,r,a,n,i)=>({addEmployee:()=>{let s=i?i("employees.newEmployee"):"New Employee",r=e.filter(e=>e.name.startsWith("".concat(s," "))).map(e=>{let t=e.name.match(new RegExp("".concat(s," (\\d+)")));return t?Number.parseInt(t[1]):0}),a=(r.length>0?Math.max(...r)+1:1).toString().padStart(3,"0"),n={id:Date.now().toString(),name:"".concat(s," ").concat(a),shiftsPerMonth:8,tags:[]};t([...e,n]),i?U.oR.success(i("toast.employeeAdded"),{description:i("toast.employeeAddedDescription",{name:n.name})}):U.oR.success("Employee added",{description:"".concat(n.name," has been added to the schedule.")})},removeEmployee:i=>{t(e.filter(e=>e.id!==i)),r(s.filter(e=>e.employeeId!==i));let l={...a};Object.keys(l).forEach(e=>{l[Number.parseInt(e)]=l[Number.parseInt(e)].filter(e=>e!==i)}),n(l)},updateEmployee:(s,r)=>{t(e.map(e=>e.id===s?{...e,...r}:e)),i?U.oR.success(i("toast.employeeUpdated"),{description:i("toast.employeeUpdatedDescription")}):U.oR.success("Employee updated",{description:"Employee information has been saved."})},toggleEmployeeTag:(s,r)=>{t(e.map(e=>{if(e.id===s){let t=e.tags.includes(r);return{...e,tags:t?e.tags.filter(e=>e!==r):[...e.tags,r]}}return e}))}}),ei=(e,t)=>({getConstraintsForEmployee:t=>e.filter(e=>e.employeeId===t),getConstraintForDate:(t,s)=>e.find(e=>e.employeeId===t&&e.date===s),removeConstraint:(s,r)=>{t(e.filter(e=>e.employeeId!==s||e.date!==r))},setConstraint:(s,r,a)=>{t([...e.filter(e=>e.employeeId!==s||e.date!==a),{id:Date.now().toString(),employeeId:s,type:r,date:a}])}});var el=s(2764),eo=s.n(el);let ed=e=>Math.floor(Math.random()*e),ec=(e,t,s,r)=>{let{shiftsPerDay:a,personsPerShift:n}=s;if(e.length<r*a*n)throw Error("Not enough slots in optimized schedule");let i={},l=0;for(let s=1;s<=r;s++){i[s]=[];for(let r=0;r<a;r++)for(let r=0;r<n;r++){let r=e[l];if(r>=0&&r<t.length)i[s].push(t[r].id),l++;else throw Error("Invalid employee index ".concat(r," in optimized schedule"))}}return i},eu=e=>{let t=[];e.forEach((e,s)=>{for(let r=0;r<e.shiftsPerMonth;r++)t.push(s)});for(let e=t.length-1;e>0;e--){let s=ed(e+1);[t[e],t[s]]=[t[s],t[e]]}return t},eh=(e,t,s,r,a,n,i)=>{let l=0,{shiftsPerDay:o,personsPerShift:d}=r,c=a*o*d,u=Array(t.length).fill(0),h=t.map(()=>({current:0,max:0})),m=Array(t.length).fill(0),x=Array(t.length).fill(0),p=t.map(()=>({current:0,max:0})),g=e.slice(0,c);if(g.length<c)throw Error("Optimized schedule does not have enough slots: expected ".concat(c,", got ").concat(g.length));g.forEach(e=>{if(e<-1||e>=t.length)throw Error("Invalid employee index ".concat(e," in optimized schedule"))});for(let e=0;e<a;e++){let r=e+1,a=e*o*d,c=a+o*d,f=g.slice(a,c);for(let e=0;e<o;e++){let t=a+e*d,s=t+d;new Set(g.slice(t,s)).size<d&&(l+=2e3)}let v=T(r,n,i);s.forEach(e=>{if("avoid"===e.type&&e.date===r){let s=t.findIndex(t=>t.id===e.employeeId);-1!==s&&f.includes(s)&&(l+=1e3)}if("prefer"===e.type&&e.date===r){let s=t.findIndex(t=>t.id===e.employeeId);-1===s||f.includes(s)||(l+=10)}});let y=[...new Set(f)];y.forEach(s=>{var r;if(u[s]++,v?m[s]++:x[s]++,e>0){let t=(e-1)*o*d,r=e*o*d,a=!1;for(let e=t;e<r;e++)if(g[e]===s){a=!0;break}a?h[s].current++:h[s].current=1}else h[s].current=1;if(h[s].max=Math.max(h[s].max,h[s].current),v&&(null==(r=t[s])?void 0:r.tags.includes("tags.weekendType"))){if(e>0){let t=T(e,n,i),r=(e-1)*o*d,a=e*o*d,l=!1;if(t){for(let e=r;e<Math.min(a,g.length);e++)if(g[e]===s){l=!0;break}}l?p[s].current++:p[s].current=1}else p[s].current=1;p[s].max=Math.max(p[s].max,p[s].current)}else p[s].current=0}),t.forEach((e,t)=>{y.includes(t)||(h[t].current=0,p[t].current=0)})}t.forEach((e,t)=>{let s=0;h[t].max>r.maxConsecutiveShifts&&(s+=(h[t].max-r.maxConsecutiveShifts)*100),e.tags.includes("tags.weekendType")&&(p[t].max>=2?s=0:s+=50),l+=s});for(let e=0;e<Math.ceil(a/7);e++){let s=7*e,n=Math.min(s+6,a-1);t.forEach((e,t)=>{let a=0,i=[];for(let e=s;e<=n;e++){let s=e*o*d,r=Math.min((e+1)*o*d,g.length),n=!1;for(let e=s;e<r;e++)if(g[e]===t){n=!0;break}n&&(a++,i.push(e))}a>r.maxShiftsPerWeek&&(l+=(a-r.maxShiftsPerWeek)*100);for(let e=0;e<i.length-1;e++){let t=i[e+1]-i[e]-1;t<r.minRestDaysBetweenShifts&&(l+=(r.minRestDaysBetweenShifts-t)*80)}})}if(r.evenDistribution){let e=u.reduce((e,t)=>e+t,0)/u.length,t=u.reduce((t,s)=>t+Math.pow(s-e,2),0)/u.length;l+=50*t}let f=m.reduce((e,t)=>e+t,0),v=x.reduce((e,t)=>e+t,0);return f>0&&v>0&&t.forEach((e,t)=>{let s=u[t];if(s>0){let e=Math.abs(m[t]/s-f/(f+v));m[t]>0&&0===x[t]&&s>1?l+=2e3:x[t]>0&&0===m[t]&&s>1?l+=1e3:e>.3&&(l+=1e3*e)}}),console.log("Cost calculated: ".concat(l)),l},em=e=>{let t=[...e];if(t.length<2)return t;let s=["swap","move","reverse","transport"],r=s[ed(s.length)],a=ed(t.length),n=ed(t.length);switch(r){case"swap":[t[a],t[n]]=[t[n],t[a]];break;case"move":{let e=t.splice(a,1)[0];t.splice(n,0,e);break}case"reverse":{let e=Math.min(a,n),s=Math.max(a,n);for(;e<s;)[t[e],t[s]]=[t[s],t[e]],e++,s--;break}case"transport":{if(t.length<3)break;let e=Math.min(a,n),s=Math.max(a,n);if(e<s){let r=t.splice(e,s-e+1),a=ed(t.length);t.splice(a,0,...r)}}}return t},ex=(e,t,s,r,a)=>{if(0===e.length)return{schedule:{},success:!1,message:"Please add employees before generating a schedule."};let n=W(r,a),i=n*s.shiftsPerDay*s.personsPerShift,l=e.reduce((e,t)=>e+t.shiftsPerMonth,0);if(l<i)return{schedule:{},success:!1,message:"Need ".concat(i," total shifts, but only ").concat(l," available.")};let o=eu(e);try{console.log("Starting optimized simulated annealing with ".concat(e.length," employees, ").concat(n," days"));let i=Date.now(),l=eo()({initialState:o,tempMax:1e3,tempMin:.1,newState:e=>em(e),getTemp:e=>.99*e,getEnergy:i=>eh(i,e,t,s,n,r,a)}),d=Date.now();console.log("Simulated annealing completed in ".concat(d-i,"ms"));let c=ec(l,e,s,n),u=eh(l,e,t,s,n,r,a),h=0===u?"Perfect schedule generated with all constraints satisfied!":"Schedule generated with optimization score: ".concat(Math.round(Math.max(0,u)));return{schedule:c,success:!0,message:h}}catch(e){return console.error("Simulated annealing failed:",e),{schedule:{},success:!1,message:"Simulated annealing failed."}}},ep=()=>{let[e,t]=(0,a.useState)(!1);return{isGenerating:e,handleGenerateSchedule:async(e,s,r,a,n,i)=>{t(!0);try{await new Promise(e=>setTimeout(e,500));let t=ex(e,s,r,a,n);t.success?(i(t.schedule),U.oR.success("Schedule generated",{description:t.message})):U.oR.error("Generation failed",{description:t.message})}catch(e){U.oR.error("Generation error",{description:"An unexpected error occurred while generating the schedule."})}finally{t(!1)}}}};function eg(){let e=(0,B.c3)(),{schedules:t,activeScheduleId:s,setActiveScheduleId:n,addSchedule:i,deleteSchedule:l,selectedMonth:o,selectedYear:p,employees:g,setEmployees:f,constraints:v,setConstraints:y,schedule:b,setSchedule:j,settings:N,setSettings:w}=ea(),{addEmployee:S,removeEmployee:k,updateEmployee:D,toggleEmployeeTag:C}=en(g,f,v,y,b,j,e),{setConstraint:E,removeConstraint:P}=ei(v,y),{isGenerating:R,handleGenerateSchedule:A}=ep(),[z,M]=(0,a.useState)("");return(0,r.jsxs)("div",{className:"container mx-auto p-6 max-w-6xl",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Schedule Manager"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage employee schedules with constraints and preferences"})]}),(0,r.jsxs)(d,{defaultValue:"setup",className:"space-y-6",children:[(0,r.jsxs)(c,{className:"grid w-full grid-cols-2",children:[(0,r.jsxs)(u,{value:"setup",className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),e("navigation.setup")]}),(0,r.jsxs)(u,{value:"constraints",className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"w-4 h-4"}),e("navigation.constraints")]})]}),(0,r.jsx)(h,{value:"setup",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(G,{schedules:t,activeScheduleId:s,onScheduleSelect:n,onScheduleAdd:i,onScheduleDelete:l}),(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,r.jsx)(Q,{employees:g,selectedEmployee:z,onEmployeeSelect:M,onAddEmployee:S,onRemoveEmployee:k,onUpdateEmployee:D,onToggleTag:C,predefinedTags:["tags.weekendType","tags.burger","tags.morningShift","tags.eveningShift","tags.manager","tags.partTime"],hasActiveSchedule:null!==s}),(0,r.jsx)("div",{className:"xl:col-span-2",children:(0,r.jsx)(es,{schedule:b,employees:g,selectedMonth:o,selectedYear:p,hasActiveSchedule:null!==s,constraints:v,selectedEmployee:z,onSetConstraint:E,onRemoveConstraint:P,onGenerateSchedule:()=>{A(g,v,N,o,p,j)},isGenerating:R})})]})]})}),(0,r.jsx)(h,{value:"constraints",children:(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(Z,{settings:N,onSettingsChange:w})})})]})]})}},9848:(e,t,s)=>{Promise.resolve().then(s.bind(s,8349))}},e=>{var t=t=>e(e.s=t);e.O(0,[699,221,441,684,358],()=>t(9848)),_N_E=e.O()}]);